
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{IST 718\_Apurva\_Spark\_Final\_Submit}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{}Import Packages:}
        
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{os}
        
        \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql} \PY{k}{import} \PY{n}{SparkSession}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        
        \PY{n}{spark} \PY{o}{=} \PY{n}{SparkSession}\PY{o}{.}\PY{n}{builder}\PY{o}{.}\PY{n}{getOrCreate}\PY{p}{(}\PY{p}{)}
        \PY{n}{sc} \PY{o}{=} \PY{n}{spark}\PY{o}{.}\PY{n}{sparkContext}
        
        \PY{k+kn}{import} \PY{n+nn}{pyspark}
        \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml} \PY{k}{import} \PY{n}{feature}\PY{p}{,} \PY{n}{regression}\PY{p}{,} \PY{n}{Pipeline}
        \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql} \PY{k}{import} \PY{n}{functions} \PY{k}{as} \PY{n}{fn}\PY{p}{,} \PY{n}{Row}
        \PY{k+kn}{from} \PY{n+nn}{pyspark} \PY{k}{import} \PY{n}{sql}
        
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        
        \PY{n}{spark} \PY{o}{=} \PY{n}{SparkSession}\PY{o}{.}\PY{n}{builder}\PY{o}{.}\PY{n}{getOrCreate}\PY{p}{(}\PY{p}{)}
        \PY{n}{sc} \PY{o}{=} \PY{n}{spark}\PY{o}{.}\PY{n}{sparkContext}
        
        \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}
        \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql}\PY{n+nn}{.}\PY{n+nn}{functions} \PY{k}{import} \PY{n}{col}\PY{p}{,}\PY{n}{udf}
        \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql}\PY{n+nn}{.}\PY{n+nn}{types} \PY{k}{import} \PY{n}{DateType}
        \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql} \PY{k}{import} \PY{n}{SQLContext}
        \PY{n}{sqlContext} \PY{o}{=} \PY{n}{SQLContext}\PY{p}{(}\PY{n}{sc}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}Reading Holiday data(US Federal) for year 2015}
        \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}excel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Weather Data/2015\PYZus{}weather\PYZus{}holiday\PYZus{}merged.xlsx}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n+nb}{format}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{y}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{errors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coerce}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:}   pickup\_date  avg\_temp\_C  Rain  Fog  Snow  Holiday
        0  2015-01-01           1     0    0     0        1
        1  2015-01-02           4     0    0     0        0
        2  2015-01-03           3     1    0     1        0
        3  2015-01-04           9     1    0     0        0
        4  2015-01-05           2     0    0     0        0
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged} \PY{o}{=} \PY{n}{spark}\PY{o}{.}\PY{n}{createDataFrame}\PY{p}{(}\PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}\PY{p}{)}
        \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged} \PY{o}{=} \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{date\PYZus{}only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fn}\PY{o}{.}\PY{n}{to\PYZus{}date}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------------------+----------+----+---+----+-------+----------+
|        pickup\_date|avg\_temp\_C|Rain|Fog|Snow|Holiday| date\_only|
+-------------------+----------+----+---+----+-------+----------+
|2015-01-01 00:00:00|         1|   0|  0|   0|      1|2015-01-01|
|2015-01-02 00:00:00|         4|   0|  0|   0|      0|2015-01-02|
|2015-01-03 00:00:00|         3|   1|  0|   1|      0|2015-01-03|
|2015-01-04 00:00:00|         9|   1|  0|   0|      0|2015-01-04|
|2015-01-05 00:00:00|         2|   0|  0|   0|      0|2015-01-05|
|2015-01-06 00:00:00|        -6|   0|  0|   1|      0|2015-01-06|
|2015-01-07 00:00:00|        -9|   0|  0|   0|      0|2015-01-07|
|2015-01-08 00:00:00|        -9|   0|  0|   0|      0|2015-01-08|
|2015-01-09 00:00:00|        -3|   0|  0|   1|      0|2015-01-09|
|2015-01-10 00:00:00|        -7|   0|  0|   0|      0|2015-01-10|
|2015-01-11 00:00:00|        -2|   0|  0|   0|      0|2015-01-11|
|2015-01-12 00:00:00|         3|   1|  0|   0|      0|2015-01-12|
|2015-01-13 00:00:00|        -3|   0|  0|   0|      0|2015-01-13|
|2015-01-14 00:00:00|        -4|   0|  0|   0|      0|2015-01-14|
|2015-01-15 00:00:00|        -1|   0|  0|   0|      0|2015-01-15|
|2015-01-16 00:00:00|         0|   0|  0|   0|      0|2015-01-16|
|2015-01-17 00:00:00|        -4|   0|  0|   0|      0|2015-01-17|
|2015-01-18 00:00:00|         3|   1|  1|   0|      0|2015-01-18|
|2015-01-19 00:00:00|         4|   0|  0|   0|      1|2015-01-19|
|2015-01-20 00:00:00|         2|   0|  0|   0|      0|2015-01-20|
+-------------------+----------+----+---+----+-------+----------+
only showing top 20 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{}Reading weather data for NYC in year 2015 }
        \PY{n}{weather\PYZus{}holiday\PYZus{}data\PYZus{}clean} \PY{o}{=} \PY{n}{raw\PYZus{}weather\PYZus{}holiday\PYZus{}merged}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{} Reading 12 months of NYC\PYZsq{}s Yellow Taxi Data for year 2015 }
        \PY{n}{raw\PYZus{}Jan\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}01\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Feb\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}02\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Mar\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}03\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Apr\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}04\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}May\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}05\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Jun\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}06\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Jul\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}07\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Aug\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}08\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Sep\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}09\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Oct\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}10\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Nov\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}11\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{raw\PYZus{}Dec\PYZus{}Data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/Taxi Data/2015\PYZhy{}12\PYZus{}100k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{frames} \PY{o}{=} \PY{p}{[}\PY{n}{raw\PYZus{}Jan\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Feb\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Mar\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Apr\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}May\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Jun\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Jul\PYZus{}Data1}\PY{p}{,}
                  \PY{n}{raw\PYZus{}Aug\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Sep\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Oct\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Nov\PYZus{}Data1}\PY{p}{,}\PY{n}{raw\PYZus{}Dec\PYZus{}Data1}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{} Merging the 3 different datasets}
        \PY{n}{Full\PYZus{}DataPD} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{frames}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{Full\PYZus{}DataPD1}\PY{o}{=}\PY{n}{Full\PYZus{}DataPD}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{}Taking sample out of 12 Million datapoints:}
        \PY{n}{Full\PYZus{}DataPDSample}\PY{o}{=} \PY{n}{Full\PYZus{}DataPD}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{l+m+mi}{60000}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{Full\PYZus{}DataPDSample1}\PY{o}{=}\PY{n}{Full\PYZus{}DataPDSample}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{Full\PYZus{}DataPDSample1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}Removing unnecessary columns:}
         \PY{n}{Full\PYZus{}DataPDSample2} \PY{o}{=} \PY{n}{Full\PYZus{}DataPDSample1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}borough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}borough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fare\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{extra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mta\PYZus{}tax}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tip\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{tolls\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{improvement\PYZus{}surcharge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}zip}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}zip}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis} \PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark} \PY{o}{=} \PY{n}{spark}\PY{o}{.}\PY{n}{createDataFrame}\PY{p}{(}\PY{n}{Full\PYZus{}DataPDSample2}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark1}\PY{o}{=} \PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark1} \PY{o}{=} \PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark1}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{date\PYZus{}only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fn}\PY{o}{.}\PY{n}{to\PYZus{}date}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}datetime}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark1}\PY{o}{.}\PY{n}{limit}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+--------+-------------------+-------------------+---------------+-------------+------------------+-----------------+----------+------------------+------------------+-----------------+------------+------------+-------------------+--------------------+----------+
|VendorID|    pickup\_datetime|   dropoff\_datetime|passenger\_count|trip\_distance|  pickup\_longitude|  pickup\_latitude|RateCodeID|store\_and\_fwd\_flag| dropoff\_longitude| dropoff\_latitude|payment\_type|total\_amount|pickup\_neighborhood|dropoff\_neighborhood| date\_only|
+--------+-------------------+-------------------+---------------+-------------+------------------+-----------------+----------+------------------+------------------+-----------------+------------+------------+-------------------+--------------------+----------+
|       1|2015-11-14 22:35:02|2015-11-14 22:43:37|              2|          0.8|-73.98409271240234|40.76068115234375|         1|                 N|-73.97766876220702|40.75379180908203|           2|         8.3|Chelsea and Clinton|Gramercy Park and{\ldots}|2015-11-14|
|       2|2015-11-14 00:29:31|2015-11-14 00:56:31|              1|         4.82|-73.98548889160156|40.76525115966797|         1|                 N|-73.91667938232422|40.76321029663085|           1|       25.56|Chelsea and Clinton|    Northwest Queens|2015-11-14|
+--------+-------------------+-------------------+---------------+-------------+------------------+-----------------+----------+------------------+------------------+-----------------+------------+------------+-------------------+--------------------+----------+
only showing top 2 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{Merged\PYZus{}FULL\PYZus{}data} \PY{o}{=} \PY{n}{weather\PYZus{}holiday\PYZus{}data\PYZus{}clean}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{Full\PYZus{}DataPDSample\PYZus{}Spark1}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date\PYZus{}only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{full}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}execute this when needed}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{Merged\PYZus{}FULL\PYZus{}data1} \PY{o}{=} \PY{n}{Merged\PYZus{}FULL\PYZus{}data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{Merged\PYZus{}FULL\PYZus{}data2} \PY{o}{=} \PY{n}{Merged\PYZus{}FULL\PYZus{}data1}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}Writing Full Merged Data:}
         \PY{c+c1}{\PYZsh{}Merged\PYZus{}FULL\PYZus{}data2.toPandas().to\PYZus{}csv(header=True, path\PYZus{}or\PYZus{}buf=\PYZsq{}/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/FullMergedData\PYZus{}Dec6.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{}Data Cleaning}
         \PY{c+c1}{\PYZsh{} from pyspark.sql.functions import isnan, when, count, col}
         \PY{c+c1}{\PYZsh{} Merged\PYZus{}FULL\PYZus{}data2.select([count(when(isnan(c), c)).alias(c) for c in Merged\PYZus{}FULL\PYZus{}data2.columns]).show()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}Read\PYZus{}Merged\PYZus{}Data2 = Read\PYZus{}Merged\PYZus{}Data2.drop(\PYZdq{}Unnamed: 0\PYZdq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}Read\PYZus{}Merged\PYZus{}Data2.printSchema()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{Merged\PYZus{}FULL\PYZus{}data2}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} 22
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{Merged\PYZus{}FULL\PYZus{}data2Pandas} \PY{o}{=} \PY{n}{Merged\PYZus{}FULL\PYZus{}data2}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{Merged\PYZus{}FULL\PYZus{}dataPandas1} \PY{o}{=} \PY{n}{Merged\PYZus{}FULL\PYZus{}data2Pandas}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{Merged\PYZus{}FULL\PYZus{}dataPandas2}\PY{o}{=} \PY{n}{Merged\PYZus{}FULL\PYZus{}dataPandas1}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{}Dummy variables creation:\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{Merged\PYZus{}FULL\PYZus{}data2}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{date\PYZus{}only}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} 
         \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} 21
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} 
         \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)} 
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} 20
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql}\PY{n+nn}{.}\PY{n+nn}{types} \PY{k}{import} \PY{n}{TimestampType}
         \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}datetime}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dummy\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{cast}\PY{p}{(}\PY{n}{TimestampType}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}datetime}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dummy\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{cast}\PY{p}{(}\PY{n}{TimestampType}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}dummy\PYZus{}df.printSchema()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{} Dummy for Rate code: base is 99}
         \PY{n}{dummy\PYZus{}df}\PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}stdrate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} 
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}JFK}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Newark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} 
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Nassau\PYZus{}W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Negotiated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} 
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{6}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df}\PY{o}{=}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCodeID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{c+c1}{\PYZsh{}base is unknown \PYZsh{}5}
         \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{payment\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}CCard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{payment\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}cash}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{payment\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}nocharge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{payment\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}dispute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{payment\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{6}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}voidtrip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{payment\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:} 29
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{}Dummy for flag : base is No}
         \PY{n}{dummy\PYZus{}df}\PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} 29
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c+c1}{\PYZsh{}Dummy creation for Vendor ID: base is 2}
         \PY{n}{dummy\PYZus{}df}\PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VendorID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VendorID\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df}\PY{o}{=}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VendorID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql} \PY{k}{import} \PY{n}{functions} \PY{k}{as} \PY{n}{F}
         \PY{n}{timeFmt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{yyyy\PYZhy{}MM\PYZhy{}dd}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{T}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{HH:mm:ss.SSS}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{timeDiff} \PY{o}{=} \PY{p}{(}\PY{n}{F}\PY{o}{.}\PY{n}{unix\PYZus{}timestamp}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{dropoff\PYZus{}datetime}\PY{p}{,} \PY{n+nb}{format}\PY{o}{=}\PY{n}{timeFmt}\PY{p}{)}
                     \PY{o}{\PYZhy{}} \PY{n}{F}\PY{o}{.}\PY{n}{unix\PYZus{}timestamp}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{pickup\PYZus{}datetime}\PY{p}{,} \PY{n+nb}{format}\PY{o}{=}\PY{n}{timeFmt}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}dummy\PYZus{}df = dummy\PYZus{}df.wfrom pyspark.sql import functions as F}
         \PY{n}{timeFmt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{yyyy\PYZhy{}MM\PYZhy{}dd}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{T}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{HH:mm:ss.SSS}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{timeDiff} \PY{o}{=} \PY{p}{(}\PY{n}{F}\PY{o}{.}\PY{n}{unix\PYZus{}timestamp}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{dropoff\PYZus{}datetime}\PY{p}{,} \PY{n+nb}{format}\PY{o}{=}\PY{n}{timeFmt}\PY{p}{)}
                     \PY{o}{\PYZhy{}} \PY{n}{F}\PY{o}{.}\PY{n}{unix\PYZus{}timestamp}\PY{p}{(}\PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{pickup\PYZus{}datetime}\PY{p}{,} \PY{n+nb}{format}\PY{o}{=}\PY{n}{timeFmt}\PY{p}{)}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df} \PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{timeDiff}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{dummy\PYZus{}df1}\PY{o}{=} \PY{n}{dummy\PYZus{}df}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{dayofweek}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dummy\PYZus{}df1}\PY{o}{.}\PY{n}{pickup\PYZus{}datetime}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{hour}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DatetimeIndex}\PY{p}{(}\PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{month}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df1}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} 33
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{c+c1}{\PYZsh{}Convert to Spark again}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{dummy\PYZus{}df1\PYZus{}Spark} \PY{o}{=} \PY{n}{spark}\PY{o}{.}\PY{n}{createDataFrame}\PY{p}{(}\PY{n}{dummy\PYZus{}df1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{dummy\PYZus{}df3Spark}\PY{o}{=} \PY{n}{dummy\PYZus{}df1\PYZus{}Spark}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{c+c1}{\PYZsh{}Conversion from long into int}
         \PY{n}{dummy\PYZus{}df3Spark}\PY{o}{.}\PY{n}{printSchema}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
root
 |-- VendorID\_1\_0: long (nullable = true)
 |-- store\_and\_fwd\_flag\_1\_0: long (nullable = true)
 |-- RateCode\_stdrate: long (nullable = true)
 |-- RateCode\_JFK: long (nullable = true)
 |-- RateCode\_Newark: long (nullable = true)
 |-- RateCode\_Nassau\_W: long (nullable = true)
 |-- RateCode\_Negotiated: long (nullable = true)
 |-- RateCode\_Group: long (nullable = true)
 |-- avg\_temp\_C: long (nullable = true)
 |-- Rain: long (nullable = true)
 |-- Fog: long (nullable = true)
 |-- Snow: long (nullable = true)
 |-- Holiday: long (nullable = true)
 |-- pickup\_datetime: timestamp (nullable = true)
 |-- dropoff\_datetime: timestamp (nullable = true)
 |-- passenger\_count: long (nullable = true)
 |-- trip\_distance: double (nullable = true)
 |-- pickup\_longitude: double (nullable = true)
 |-- pickup\_latitude: double (nullable = true)
 |-- dropoff\_longitude: double (nullable = true)
 |-- dropoff\_latitude: double (nullable = true)
 |-- total\_amount: double (nullable = true)
 |-- pickup\_neighborhood: string (nullable = true)
 |-- dropoff\_neighborhood: string (nullable = true)
 |-- ptype\_CCard: long (nullable = true)
 |-- ptype\_cash: long (nullable = true)
 |-- ptype\_nocharge: long (nullable = true)
 |-- ptype\_dispute: long (nullable = true)
 |-- ptype\_voidtrip: long (nullable = true)
 |-- Duration: long (nullable = true)
 |-- day\_of\_week: long (nullable = true)
 |-- pickup\_hour: long (nullable = true)
 |-- month: long (nullable = true)


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{dummy\PYZus{}df3Spark} \PY{o}{=} \PY{n}{dummy\PYZus{}df3Spark}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cast}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df3Spark} \PY{o}{=} \PY{n}{dummy\PYZus{}df3Spark}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}temp\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cast}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df3Spark} \PY{o}{=} \PY{n}{dummy\PYZus{}df3Spark}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{passenger\PYZus{}count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cast}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{dummy\PYZus{}df3Spark}\PY{o}{.}\PY{n}{printSchema}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
root
 |-- VendorID\_1\_0: long (nullable = true)
 |-- store\_and\_fwd\_flag\_1\_0: long (nullable = true)
 |-- RateCode\_stdrate: long (nullable = true)
 |-- RateCode\_JFK: long (nullable = true)
 |-- RateCode\_Newark: long (nullable = true)
 |-- RateCode\_Nassau\_W: long (nullable = true)
 |-- RateCode\_Negotiated: long (nullable = true)
 |-- RateCode\_Group: long (nullable = true)
 |-- avg\_temp\_C: integer (nullable = true)
 |-- Rain: long (nullable = true)
 |-- Fog: long (nullable = true)
 |-- Snow: long (nullable = true)
 |-- Holiday: long (nullable = true)
 |-- pickup\_datetime: timestamp (nullable = true)
 |-- dropoff\_datetime: timestamp (nullable = true)
 |-- passenger\_count: integer (nullable = true)
 |-- trip\_distance: double (nullable = true)
 |-- pickup\_longitude: double (nullable = true)
 |-- pickup\_latitude: double (nullable = true)
 |-- dropoff\_longitude: double (nullable = true)
 |-- dropoff\_latitude: double (nullable = true)
 |-- total\_amount: double (nullable = true)
 |-- pickup\_neighborhood: string (nullable = true)
 |-- dropoff\_neighborhood: string (nullable = true)
 |-- ptype\_CCard: long (nullable = true)
 |-- ptype\_cash: long (nullable = true)
 |-- ptype\_nocharge: long (nullable = true)
 |-- ptype\_dispute: long (nullable = true)
 |-- ptype\_voidtrip: long (nullable = true)
 |-- Duration: integer (nullable = true)
 |-- day\_of\_week: long (nullable = true)
 |-- pickup\_hour: long (nullable = true)
 |-- month: long (nullable = true)


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df3Spark}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} 33
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{c+c1}{\PYZsh{}Remove Zipcodes\PYZsq{}s}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean} \PY{o}{=} \PY{n}{dummy\PYZus{}df3Spark}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean}\PY{o}{.}\PY{n}{printSchema}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
root
 |-- VendorID\_1\_0: long (nullable = true)
 |-- store\_and\_fwd\_flag\_1\_0: long (nullable = true)
 |-- RateCode\_stdrate: long (nullable = true)
 |-- RateCode\_JFK: long (nullable = true)
 |-- RateCode\_Newark: long (nullable = true)
 |-- RateCode\_Nassau\_W: long (nullable = true)
 |-- RateCode\_Negotiated: long (nullable = true)
 |-- RateCode\_Group: long (nullable = true)
 |-- avg\_temp\_C: integer (nullable = true)
 |-- Rain: long (nullable = true)
 |-- Fog: long (nullable = true)
 |-- Snow: long (nullable = true)
 |-- Holiday: long (nullable = true)
 |-- pickup\_datetime: timestamp (nullable = true)
 |-- dropoff\_datetime: timestamp (nullable = true)
 |-- passenger\_count: integer (nullable = true)
 |-- trip\_distance: double (nullable = true)
 |-- pickup\_longitude: double (nullable = true)
 |-- pickup\_latitude: double (nullable = true)
 |-- dropoff\_longitude: double (nullable = true)
 |-- dropoff\_latitude: double (nullable = true)
 |-- total\_amount: double (nullable = true)
 |-- pickup\_neighborhood: string (nullable = true)
 |-- dropoff\_neighborhood: string (nullable = true)
 |-- ptype\_CCard: long (nullable = true)
 |-- ptype\_cash: long (nullable = true)
 |-- ptype\_nocharge: long (nullable = true)
 |-- ptype\_dispute: long (nullable = true)
 |-- ptype\_voidtrip: long (nullable = true)
 |-- Duration: integer (nullable = true)
 |-- day\_of\_week: long (nullable = true)
 |-- pickup\_hour: long (nullable = true)
 |-- month: long (nullable = true)


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{c+c1}{\PYZsh{}Distinct neighborhoods in \PYZsq{}pickup\PYZus{}neighborhood\PYZsq{} column}
         \PY{n}{distinct\PYZus{}neighborhoods} \PY{o}{=} \PY{p}{[}\PY{n}{i}\PY{o}{.}\PY{n}{pickup\PYZus{}neighborhood} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{dummy\PYZus{}df\PYZus{}clean}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{distinct}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{collect}\PY{p}{(}\PY{p}{)}\PY{p}{]}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{distinct\PYZus{}neighborhoods}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['Northeast Bronx', 'Lower Manhattan', 'Southeast Queens', 'Upper East Side', 'Central Brooklyn', 'Gramercy Park and Murray Hill', 'West Central Queens', 'Central Bronx', 'East Harlem', 'Southwest Queens', 'Lower East Side', 'Bushwick and Williamsburg', 'Bronx Park and Fordham', 'Sunset Park', 'Chelsea and Clinton', 'Hunts Point and Mott Haven', 'High Bridge and Morrisania', 'Upper West Side', 'Northeast Queens', 'Canarsie and Flatlands', 'East New York and New Lots', 'West Queens', 'Northwest Queens', 'Central Queens', 'Jamaica', 'Southwest Brooklyn', 'Borough Park', 'Central Harlem', 'Southeast Bronx', 'Southern Brooklyn', 'Flatbush', 'Greenwich Village and Soho', 'Northwest Brooklyn', 'North Queens', 'Stapleton and St. George', 'Inwood and Washington Heights', 'Greenpoint', 'Kingsbridge and Riverdale']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{distinct\PYZus{}neighborhoods}\PY{p}{)}
         \PY{n+nb}{len} \PY{p}{(}\PY{n}{distinct\PYZus{}neighborhoods}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:} 38
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{}Show Top 10 neighborhoods}
         \PY{n}{top10\PYZus{}Pickup\PYZus{}neighborhoods} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{top10\PYZus{}Pickup\PYZus{}neighborhoods}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} pyspark.sql.dataframe.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{top10\PYZus{}Pickup\PYZus{}neighborhoods}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:}              pickup\_neighborhood  count
         0            Chelsea and Clinton  16370
         1  Gramercy Park and Murray Hill  13062
         2                Upper East Side   9354
         3     Greenwich Village and Soho   5594
         4                Upper West Side   5170
         5                Lower East Side   3706
         6                Lower Manhattan   2551
         7                    West Queens   1623
         8             Northwest Brooklyn    511
         9                    East Harlem    453
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{c+c1}{\PYZsh{}Show Top 10 neighborhoods}
         \PY{n}{top10\PYZus{}DropOff\PYZus{}neighborhoods} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{top10\PYZus{}DropOff\PYZus{}neighborhoods}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}57}]:}             dropoff\_neighborhood  count
         0            Chelsea and Clinton  14710
         1  Gramercy Park and Murray Hill  12330
         2                Upper East Side   9020
         3                Upper West Side   5130
         4     Greenwich Village and Soho   4945
         5                Lower East Side   3409
         6                Lower Manhattan   2689
         7                    West Queens   1074
         8             Northwest Brooklyn    983
         9                    East Harlem    922
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{=}\PY{n}{dummy\PYZus{}df\PYZus{}clean}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PYZbs{}
                        \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Chelsea and Clinton}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{\PYZam{}}\PYZbs{}
                                \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gramercy Park and Murray Hill}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Upper East Side}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                                \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Upper West Side}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Greenwich Village and Soho}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lower East Side}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lower Manhattan}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{West Queens}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Northwest Brooklyn}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Northwest Queens}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Other}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{withColumn}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PYZbs{}
                        \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Chelsea and Clinton}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gramercy Park and Murray Hill}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Upper East Side}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Upper West Side}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Greenwich Village and Soho}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lower Manhattan}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lower East Side}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{West Queens}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Northwest Brooklyn}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
                             \PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Central Harlem	}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Other}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}neighborhood}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Chelsea and Clinton}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gramercy Park and Murray Hill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Upper East Side}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Greenwich Village and Soho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Upper West Side}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lower East Side}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lower Manhattan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{West Queens}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Northwest Brooklyn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Northwest Queens}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}
                                   \PY{p}{)}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Chelsea and Clinton}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gramercy Park and Murray Hill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Upper East Side}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Greenwich Village and Soho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Upper West Side}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lower East Side}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lower Manhattan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{West Queens}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Northwest Brooklyn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Central Harlem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ch}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}
                                   \PY{p}{)}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}neighborhood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tuesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wednesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Friday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Saturday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}
                                   \PY{p}{)}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{8}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{9}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{10}\PY{p}{)} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{11}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{12}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Winter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                    \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{3}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spring}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{3}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{4}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{5}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{6}\PY{p}{)} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Morning}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{6}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{7}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{8}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{9}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{10}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{11}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{12}\PY{p}{)} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Afternoon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                         \PY{n}{fn}\PY{o}{.}\PY{n}{when}\PY{p}{(}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{12}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{13}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{14}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{15}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{16}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{17}\PY{p}{)} \PY{o}{|}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{col}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{18}\PY{p}{)} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{otherwise}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Evening}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean1} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean1}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}265}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean1}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}265}]:} 61
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas = dummy\PYZus{}df\PYZus{}clean1.toPandas()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{}Writing clean data:}
         \PY{c+c1}{\PYZsh{}dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark.toPandas().to\PYZus{}csv(header=True, path\PYZus{}or\PYZus{}buf=\PYZdq{}/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/dummy\PYZus{}df\PYZus{}clean\PYZus{}Dec6.csv\PYZdq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}CORRELATION MATRIX:\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{}read Clean data :}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/Users/apsharma/IST718 Dropbox/IST718Project\PYZus{}Data/dummy\PYZus{}df\PYZus{}clean(61Cols)\PYZus{}Dec3.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}74}]:} Index(['Unnamed: 0', 'Morning', 'Afternoon', 'Evening', 'Fall', 'Winter',
                'Spring', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday',
                'Saturday', 'Sunday', 'dropoff\_cc', 'dropoff\_GM', 'dropoff\_ues',
                'dropoff\_Gvs', 'dropoff\_Uws', 'dropoff\_Les', 'dropoff\_Lm', 'dropoff\_Wq',
                'dropoff\_Nb', 'dropoff\_ch', 'Pickup\_cc', 'Pickup\_GM', 'Pickup\_ues',
                'Pickup\_Gvs', 'Pickup\_Uws', 'Pickup\_Les', 'Pickup\_Lm', 'Pickup\_Wq',
                'Pickup\_Nb', 'Pickup\_Nq', 'VendorID\_1\_0', 'store\_and\_fwd\_flag\_1\_0',
                'RateCode\_stdrate', 'RateCode\_JFK', 'RateCode\_Newark',
                'RateCode\_Nassau\_W', 'RateCode\_Negotiated', 'RateCode\_Group',
                'avg\_temp\_C', 'Rain', 'Fog', 'Snow', 'Holiday', 'pickup\_datetime',
                'dropoff\_datetime', 'passenger\_count', 'trip\_distance',
                'pickup\_longitude', 'pickup\_latitude', 'dropoff\_longitude',
                'dropoff\_latitude', 'total\_amount', 'ptype\_CCard', 'ptype\_cash',
                'ptype\_nocharge', 'ptype\_dispute', 'ptype\_voidtrip', 'Duration'],
               dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis} \PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}76}]:} Index(['Morning', 'Afternoon', 'Evening', 'Fall', 'Winter', 'Spring', 'Monday',
                'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday',
                'dropoff\_cc', 'dropoff\_GM', 'dropoff\_ues', 'dropoff\_Gvs', 'dropoff\_Uws',
                'dropoff\_Les', 'dropoff\_Lm', 'dropoff\_Wq', 'dropoff\_Nb', 'dropoff\_ch',
                'Pickup\_cc', 'Pickup\_GM', 'Pickup\_ues', 'Pickup\_Gvs', 'Pickup\_Uws',
                'Pickup\_Les', 'Pickup\_Lm', 'Pickup\_Wq', 'Pickup\_Nb', 'Pickup\_Nq',
                'VendorID\_1\_0', 'store\_and\_fwd\_flag\_1\_0', 'RateCode\_stdrate',
                'RateCode\_JFK', 'RateCode\_Newark', 'RateCode\_Nassau\_W',
                'RateCode\_Negotiated', 'RateCode\_Group', 'avg\_temp\_C', 'Rain', 'Fog',
                'Snow', 'Holiday', 'pickup\_datetime', 'dropoff\_datetime',
                'passenger\_count', 'trip\_distance', 'pickup\_longitude',
                'pickup\_latitude', 'dropoff\_longitude', 'dropoff\_latitude',
                'total\_amount', 'ptype\_CCard', 'ptype\_cash', 'ptype\_nocharge',
                'ptype\_dispute', 'ptype\_voidtrip', 'Duration'],
               dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}\PY{o}{.}\PY{n}{printSchema}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
root
 |-- Morning: integer (nullable = false)
 |-- Afternoon: integer (nullable = false)
 |-- Evening: integer (nullable = false)
 |-- Fall: integer (nullable = false)
 |-- Winter: integer (nullable = false)
 |-- Spring: integer (nullable = false)
 |-- Monday: integer (nullable = false)
 |-- Tuesday: integer (nullable = false)
 |-- Wednesday: integer (nullable = false)
 |-- Thursday: integer (nullable = false)
 |-- Friday: integer (nullable = false)
 |-- Saturday: integer (nullable = false)
 |-- Sunday: integer (nullable = false)
 |-- dropoff\_cc: integer (nullable = false)
 |-- dropoff\_GM: integer (nullable = false)
 |-- dropoff\_ues: integer (nullable = false)
 |-- dropoff\_Gvs: integer (nullable = false)
 |-- dropoff\_Uws: integer (nullable = false)
 |-- dropoff\_Les: integer (nullable = false)
 |-- dropoff\_Lm: integer (nullable = false)
 |-- dropoff\_Wq: integer (nullable = false)
 |-- dropoff\_Nb: integer (nullable = false)
 |-- dropoff\_ch: integer (nullable = false)
 |-- Pickup\_cc: integer (nullable = false)
 |-- Pickup\_GM: integer (nullable = false)
 |-- Pickup\_ues: integer (nullable = false)
 |-- Pickup\_Gvs: integer (nullable = false)
 |-- Pickup\_Uws: integer (nullable = false)
 |-- Pickup\_Les: integer (nullable = false)
 |-- Pickup\_Lm: integer (nullable = false)
 |-- Pickup\_Wq: integer (nullable = false)
 |-- Pickup\_Nb: integer (nullable = false)
 |-- Pickup\_Nq: integer (nullable = false)
 |-- VendorID\_1\_0: long (nullable = true)
 |-- store\_and\_fwd\_flag\_1\_0: long (nullable = true)
 |-- RateCode\_stdrate: long (nullable = true)
 |-- RateCode\_JFK: long (nullable = true)
 |-- RateCode\_Newark: long (nullable = true)
 |-- RateCode\_Nassau\_W: long (nullable = true)
 |-- RateCode\_Negotiated: long (nullable = true)
 |-- RateCode\_Group: long (nullable = true)
 |-- avg\_temp\_C: integer (nullable = true)
 |-- Rain: long (nullable = true)
 |-- Fog: long (nullable = true)
 |-- Snow: long (nullable = true)
 |-- Holiday: long (nullable = true)
 |-- pickup\_datetime: timestamp (nullable = true)
 |-- dropoff\_datetime: timestamp (nullable = true)
 |-- passenger\_count: integer (nullable = true)
 |-- trip\_distance: double (nullable = true)
 |-- pickup\_longitude: double (nullable = true)
 |-- pickup\_latitude: double (nullable = true)
 |-- dropoff\_longitude: double (nullable = true)
 |-- dropoff\_latitude: double (nullable = true)
 |-- total\_amount: double (nullable = true)
 |-- ptype\_CCard: long (nullable = true)
 |-- ptype\_cash: long (nullable = true)
 |-- ptype\_nocharge: long (nullable = true)
 |-- ptype\_dispute: long (nullable = true)
 |-- ptype\_voidtrip: long (nullable = true)
 |-- Duration: integer (nullable = true)


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{c+c1}{\PYZsh{}Numeric Features for correlations}
         \PY{n}{numeric\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{n}{t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}\PY{o}{.}\PY{n}{dtypes} \PY{k}{if} \PY{n}{t}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{double}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{or} \PY{n}{t}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{integer}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{or} \PY{n}{t}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{long}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{numeric\PYZus{}features}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}79}]:} list
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{c+c1}{\PYZsh{}CORRELATION MATRIX:}
         \PY{c+c1}{\PYZsh{}Correlations between independent variables.}
         \PY{n}{numeric\PYZus{}data} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{n}{numeric\PYZus{}features}\PY{p}{)}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}
         \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{mllib}\PY{n+nn}{.}\PY{n+nn}{stat} \PY{k}{import} \PY{n}{Statistics}
         \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{linalg} \PY{k}{import} \PY{n}{Vectors}
         \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{stat} \PY{k}{import} \PY{n}{Correlation}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{va\PYZus{}corr} \PY{o}{=} \PY{n}{feature}\PY{o}{.}\PY{n}{VectorAssembler}\PY{p}{(}\PY{n}{inputCols}\PY{o}{=}\PY{p}{[}\PY{n}{c} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{numeric\PYZus{}data}\PY{p}{]} \PY{p}{,} \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{dummy\PYZus{}df\PYZus{}corr} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{features\PYZus{}sample\PYZus{}df} \PY{o}{=} \PY{n}{va\PYZus{}corr}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}corr}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{stat} \PY{k}{import} \PY{n}{Correlation}
         \PY{n}{r1} \PY{o}{=} \PY{n}{Correlation}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{features\PYZus{}sample\PYZus{}df}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{r1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{toArray}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} array([[ 1.        ,  0.31408967, -0.02414641,  0.38856186, -0.08764108,
                  0.92866386],
                [ 0.31408967,  1.        ,  0.49406315,  0.28679299,  0.1784735 ,
                  0.30619543],
                [-0.02414641,  0.49406315,  1.        ,  0.20792481,  0.47921782,
                 -0.0252671 ],
                [ 0.38856186,  0.28679299,  0.20792481,  1.        ,  0.3808814 ,
                  0.32692778],
                [-0.08764108,  0.1784735 ,  0.47921782,  0.3808814 ,  1.        ,
                 -0.09621779],
                [ 0.92866386,  0.30619543, -0.0252671 ,  0.32692778, -0.09621779,
                  1.        ]])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{r1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}86}]:} pyspark.sql.types.Row
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} Visualization of above Correlation in Pandas \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{c+c1}{\PYZsh{}We dropped correlated columns for our modelling analysis:}
         \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas2} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RateCode\PYZus{}Nassau\PYZus{}W}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RateCode\PYZus{}Group}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ptype\PYZus{}voidtrip}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{VendorID\PYZus{}1\PYZus{}0}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                                            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag\PYZus{}1\PYZus{}0}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RateCode\PYZus{}Newark}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RateCode\PYZus{}Negotiated}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ptype\PYZus{}nocharge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                                             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ptype\PYZus{}dispute}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}ch}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Monday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Tuesday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                                             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Wednesday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Thursday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Friday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Saturday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Sunday}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}cc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}GM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                                              \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}ues}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}Gvs}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}Uws}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}Les}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}Lm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}Wq}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                                             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}Nb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}cc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}GM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}ues}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}Gvs}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}Uws}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                                             \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}Les}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}Lm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}Wq}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pickup\PYZus{}Nb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas2}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}89}]:} False
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         
         \PY{n}{rs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{RandomState}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}df = pd.DataFrame(rs.rand(10, 10))}
         \PY{n}{corr} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas2}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
         \PY{n}{corr}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{background\PYZus{}gradient}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:} <pandas.io.formats.style.Styler at 0x12df1d160>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{k+kn}{from} \PY{n+nn}{string} \PY{k}{import} \PY{n}{ascii\PYZus{}letters}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         
         \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{white}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Compute the correlation matrix}
         \PY{n}{corr} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Pandas2}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Generate a mask for the upper triangle}
         \PY{n}{mask} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{bool}\PY{p}{)}
         \PY{n}{mask}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{triu\PYZus{}indices\PYZus{}from}\PY{p}{(}\PY{n}{mask}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{k+kc}{True}
         
         \PY{c+c1}{\PYZsh{} Set up the matplotlib figure}
         \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{11}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Generate a custom diverging colormap}
         \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{diverging\PYZus{}palette}\PY{p}{(}\PY{l+m+mi}{220}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Draw the heatmap with the mask and correct aspect ratio}
         \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{mask}\PY{o}{=}\PY{n}{mask}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                     \PY{n}{square}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cbar\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shrink}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{o}{.}\PY{l+m+mi}{5}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}91}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x12d968a90>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}PCA}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}310}]:} \PY{n}{va\PYZus{}PCA}\PY{o}{=}\PY{n}{feature}\PY{o}{.}\PY{n}{VectorAssembler}\PY{p}{(}\PY{n}{inputCols}\PY{o}{=}\PY{p}{[}\PY{n}{c} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{numeric\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{]}\PY{p}{,}
                                     \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{sc\PYZus{}PCA}\PY{o}{=}\PY{n}{feature}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{n}{withMean}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                                     \PY{n}{inputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zfeatures}\PY{l+s+s1}{\PYZsq{}}
                                    \PY{p}{)}
          \PY{n}{pca}\PY{o}{=} \PY{n}{feature}\PY{o}{.}\PY{n}{PCA}\PY{p}{(}\PY{n}{k}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{,} \PY{n}{inputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zfeatures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PCAloadings}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}311}]:} \PY{n}{pipeline\PYZus{}one\PYZus{}PCA} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{n}{stages}\PY{o}{=}\PY{p}{[} \PY{n}{va\PYZus{}PCA}\PY{p}{,}\PY{n}{sc\PYZus{}PCA}\PY{p}{,}\PY{n}{pca}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}283}]:} \PY{n}{explainedVariance} \PY{o}{=} \PY{n}{pipeline\PYZus{}one\PYZus{}PCA}\PY{o}{.}\PY{n}{stages}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{explainedVariance}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}312}]:} \PY{n}{best\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{0}
          \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{explainedVariance}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n}{explainedVariance}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.05}\PY{p}{:}
                  \PY{n}{best\PYZus{}k} \PY{o}{=} \PY{n}{k}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
                  \PY{k}{break}
          \PY{n}{best\PYZus{}k}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}312}]:} 4
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}313}]:} \PY{n}{explainedVariance}\PY{p}{[}\PY{n}{best\PYZus{}k}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}313}]:} 0.057540153757355404
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}314}]:} \PY{n}{principal\PYZus{}components} \PY{o}{=} \PY{n}{pipeline\PYZus{}one\PYZus{}PCA}\PY{o}{.}\PY{n}{stages}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{pc}\PY{o}{.}\PY{n}{toArray}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}315}]:} \PY{n}{principal\PYZus{}components}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}315}]:} array([[-0.52639206,  0.3837901 , -0.02447939,  0.23772706, -0.0300041 ,
                   0.71944625],
                 [-0.42124128, -0.22758543,  0.58199093, -0.43978061,  0.48850642,
                  -0.00130838],
                 [-0.25167869, -0.5557811 ,  0.35765083,  0.28167669, -0.64845205,
                   0.00438992],
                 [-0.43006642, -0.1502623 , -0.58369045, -0.60325007, -0.28872113,
                  -0.06707479],
                 [-0.1844926 , -0.56091676, -0.43787431,  0.45008447,  0.50650996,
                   0.02173906],
                 [-0.51296235,  0.39346032,  0.01856723,  0.32287834,  0.00767764,
                  -0.69094464]])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}316}]:} \PY{n}{z} \PY{o}{=} \PY{n}{pipeline\PYZus{}one\PYZus{}PCA}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}\PY{p}{)}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zfeatures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PCAloadings}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{first}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zfeatures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}317}]:} \PY{n}{z}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{principal\PYZus{}components}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}317}]:} array([ 0.92203183, -1.02685208,  0.21456233, -0.03637755, -0.16163563,
                  0.04985908])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}327}]:} \PY{n}{abs\PYZus{}loading\PYZus{}list}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{p}{[}\PY{n}{c} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{numeric\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{]}\PY{p}{,}\PY{n}{principal\PYZus{}components}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}328}]:} \PY{n}{pc\PYZus{}best} \PY{o}{=} \PY{n}{pipeline\PYZus{}one\PYZus{}PCA}\PY{o}{.}\PY{n}{stages}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{pc}\PY{o}{.}\PY{n}{toArray}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}329}]:} \PY{n}{abs\PYZus{}loading\PYZus{}list}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}329}]:} [('trip\_distance', 0.7194462527899649),
           ('pickup\_longitude', -0.0013083750165691216),
           ('pickup\_latitude', 0.00438991561735012),
           ('dropoff\_longitude', -0.06707478874493442),
           ('dropoff\_latitude', 0.021739061209638255),
           ('total\_amount', -0.6909446374889328)]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}330}]:} \PY{n}{pc\PYZus{}loadings} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{abs\PYZus{}loading\PYZus{}list}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                                                    \PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pc\PYZus{}best}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}331}]:} \PY{n}{pc\PYZus{}loadings}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}331}]:}              Feature   pc\_best
          0      trip\_distance  0.719446
          1   pickup\_longitude -0.001308
          2    pickup\_latitude  0.004390
          3  dropoff\_longitude -0.067075
          4   dropoff\_latitude  0.021739
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}332}]:} \PY{n}{feature\PYZus{}engineering\PYZus{}duration}\PY{o}{=}\PY{n}{pc\PYZus{}loadings}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pc\PYZus{}best}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PYZbs{}
              \PY{n}{apply}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pc\PYZus{}best}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}333}]:} \PY{n}{feature\PYZus{}engineering\PYZus{}duration}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}333}]:}              Feature   pc\_best
          5       total\_amount  0.690945
          3  dropoff\_longitude  0.067075
          1   pickup\_longitude  0.001308
          2    pickup\_latitude  0.004390
          4   dropoff\_latitude  0.021739
          0      trip\_distance  0.719446
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}306}]:} \PY{n}{selected\PYZus{}features}\PY{o}{=}\PY{n}{feature\PYZus{}engineering\PYZus{}duration}\PY{p}{[}\PY{n}{feature\PYZus{}engineering\PYZus{}duration}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pc\PYZus{}best}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mf}{0.01}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}307}]:} \PY{n}{selected\PYZus{}features}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}307}]:} ['total\_amount', 'dropoff\_longitude', 'dropoff\_latitude', 'trip\_distance']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{c+c1}{\PYZsh{}Exploratory Data Analysis:}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}341}]:} \PY{n}{dummy\PYZus{}df1}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}341}]:} Index(['VendorID\_1\_0', 'store\_and\_fwd\_flag\_1\_0', 'RateCode\_stdrate',
                 'RateCode\_JFK', 'RateCode\_Newark', 'RateCode\_Nassau\_W',
                 'RateCode\_Negotiated', 'RateCode\_Group', 'avg\_temp\_C', 'Rain', 'Fog',
                 'Snow', 'Holiday', 'pickup\_datetime', 'dropoff\_datetime',
                 'passenger\_count', 'trip\_distance', 'pickup\_longitude',
                 'pickup\_latitude', 'dropoff\_longitude', 'dropoff\_latitude',
                 'total\_amount', 'pickup\_neighborhood', 'dropoff\_neighborhood',
                 'ptype\_CCard', 'ptype\_cash', 'ptype\_nocharge', 'ptype\_dispute',
                 'ptype\_voidtrip', 'Duration', 'day\_of\_week', 'pickup\_hour', 'month'],
                dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}342}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{dummy\PYZus{}df1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}342}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}343}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)} 
          \PY{n}{dummy\PYZus{}df1}\PY{o}{.}\PY{n}{pickup\PYZus{}hour}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{red}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gold}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{align}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{width}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{rotation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horizontal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of trips}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total pickups at each hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_111_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}346}]:} \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime} \PY{k}{as} \PY{n}{dt}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}348}]:} \PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropOff\PYZus{}hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{=}\PY{n}{dummy\PYZus{}df1}\PY{o}{.}\PY{n}{dropoff\PYZus{}datetime}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{hour}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}349}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{dummy\PYZus{}df1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{palette}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Set3}\PY{l+s+s2}{\PYZdq{}} \PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Duration }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distribution of Duration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}351}]:} \PY{n}{taxi\PYZus{}rate} \PY{o}{=} \PY{n}{dummy\PYZus{}df1}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{taxi\PYZus{}rate}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{taxi\PYZus{}rate}\PY{o}{.}\PY{n}{total\PYZus{}amount}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average Fare Price Per Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average Fare Price Over a Month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}Scaling:\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{n}{dummy\PYZus{}df\PYZus{}toBe\PYZus{}Scaled}\PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}clean\PYZus{}61cols\PYZus{}Spark}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{dummy\PYZus{}df\PYZus{}toBe\PYZus{}Scaled}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}94}]:} 61
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{n}{data} \PY{o}{=} \PY{n}{dummy\PYZus{}df\PYZus{}toBe\PYZus{}Scaled}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{c+c1}{\PYZsh{}dummy\PYZus{}df\PYZus{}toBe\PYZus{}Scaled.toPandas().to\PYZus{}csv(header=True, path\PYZus{}or\PYZus{}buf=\PYZsq{}/Users/apsharma/IST718 Dropbox/Final/dummy\PYZus{}df\PYZus{}toBe\PYZus{}ScaledForTotalAmt\PYZus{}Dec5.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}97}]:} \PY{c+c1}{\PYZsh{}read data if server error\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{c+c1}{\PYZsh{}read data :}
          \PY{c+c1}{\PYZsh{}data1 = pd.read\PYZus{}csv(\PYZdq{}/Users/apsharma/IST718 Dropbox/Final/dummy\PYZus{}df\PYZus{}toBe\PYZus{}ScaledForTotalAmt\PYZus{}Dec5.csv\PYZdq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{data}\PY{o}{.}\PY{n}{printSchema}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
root
 |-- Morning: integer (nullable = false)
 |-- Afternoon: integer (nullable = false)
 |-- Evening: integer (nullable = false)
 |-- Fall: integer (nullable = false)
 |-- Winter: integer (nullable = false)
 |-- Spring: integer (nullable = false)
 |-- Monday: integer (nullable = false)
 |-- Tuesday: integer (nullable = false)
 |-- Wednesday: integer (nullable = false)
 |-- Thursday: integer (nullable = false)
 |-- Friday: integer (nullable = false)
 |-- Saturday: integer (nullable = false)
 |-- Sunday: integer (nullable = false)
 |-- dropoff\_cc: integer (nullable = false)
 |-- dropoff\_GM: integer (nullable = false)
 |-- dropoff\_ues: integer (nullable = false)
 |-- dropoff\_Gvs: integer (nullable = false)
 |-- dropoff\_Uws: integer (nullable = false)
 |-- dropoff\_Les: integer (nullable = false)
 |-- dropoff\_Lm: integer (nullable = false)
 |-- dropoff\_Wq: integer (nullable = false)
 |-- dropoff\_Nb: integer (nullable = false)
 |-- dropoff\_ch: integer (nullable = false)
 |-- Pickup\_cc: integer (nullable = false)
 |-- Pickup\_GM: integer (nullable = false)
 |-- Pickup\_ues: integer (nullable = false)
 |-- Pickup\_Gvs: integer (nullable = false)
 |-- Pickup\_Uws: integer (nullable = false)
 |-- Pickup\_Les: integer (nullable = false)
 |-- Pickup\_Lm: integer (nullable = false)
 |-- Pickup\_Wq: integer (nullable = false)
 |-- Pickup\_Nb: integer (nullable = false)
 |-- Pickup\_Nq: integer (nullable = false)
 |-- VendorID\_1\_0: long (nullable = true)
 |-- store\_and\_fwd\_flag\_1\_0: long (nullable = true)
 |-- RateCode\_stdrate: long (nullable = true)
 |-- RateCode\_JFK: long (nullable = true)
 |-- RateCode\_Newark: long (nullable = true)
 |-- RateCode\_Nassau\_W: long (nullable = true)
 |-- RateCode\_Negotiated: long (nullable = true)
 |-- RateCode\_Group: long (nullable = true)
 |-- avg\_temp\_C: integer (nullable = true)
 |-- Rain: long (nullable = true)
 |-- Fog: long (nullable = true)
 |-- Snow: long (nullable = true)
 |-- Holiday: long (nullable = true)
 |-- pickup\_datetime: timestamp (nullable = true)
 |-- dropoff\_datetime: timestamp (nullable = true)
 |-- passenger\_count: integer (nullable = true)
 |-- trip\_distance: double (nullable = true)
 |-- pickup\_longitude: double (nullable = true)
 |-- pickup\_latitude: double (nullable = true)
 |-- dropoff\_longitude: double (nullable = true)
 |-- dropoff\_latitude: double (nullable = true)
 |-- total\_amount: double (nullable = true)
 |-- ptype\_CCard: long (nullable = true)
 |-- ptype\_cash: long (nullable = true)
 |-- ptype\_nocharge: long (nullable = true)
 |-- ptype\_dispute: long (nullable = true)
 |-- ptype\_voidtrip: long (nullable = true)
 |-- Duration: integer (nullable = true)


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}  Scaling and Standardization:}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{c+c1}{\PYZsh{}Important \PYZhy{} Removing some columns for Total Amount and Duration prediction !!!}
          \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}datetime}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dropoff\PYZus{}datetime}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pickup\PYZus{}weekday\PYZus{}name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trip\PYZus{}distance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passenger\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}105}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}105}]:} 57
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n}{data}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}106}]:} ['Morning',
           'Afternoon',
           'Evening',
           'Fall',
           'Winter',
           'Spring',
           'Monday',
           'Tuesday',
           'Wednesday',
           'Thursday',
           'Friday',
           'Saturday',
           'Sunday',
           'dropoff\_cc',
           'dropoff\_GM',
           'dropoff\_ues',
           'dropoff\_Gvs',
           'dropoff\_Uws',
           'dropoff\_Les',
           'dropoff\_Lm',
           'dropoff\_Wq',
           'dropoff\_Nb',
           'dropoff\_ch',
           'Pickup\_cc',
           'Pickup\_GM',
           'Pickup\_ues',
           'Pickup\_Gvs',
           'Pickup\_Uws',
           'Pickup\_Les',
           'Pickup\_Lm',
           'Pickup\_Wq',
           'Pickup\_Nb',
           'Pickup\_Nq',
           'VendorID\_1\_0',
           'store\_and\_fwd\_flag\_1\_0',
           'RateCode\_stdrate',
           'RateCode\_JFK',
           'RateCode\_Newark',
           'RateCode\_Nassau\_W',
           'RateCode\_Negotiated',
           'RateCode\_Group',
           'avg\_temp\_C',
           'Rain',
           'Fog',
           'Snow',
           'Holiday',
           'pickup\_longitude',
           'pickup\_latitude',
           'dropoff\_longitude',
           'dropoff\_latitude',
           'total\_amount',
           'ptype\_CCard',
           'ptype\_cash',
           'ptype\_nocharge',
           'ptype\_dispute',
           'ptype\_voidtrip',
           'Duration']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{feature} \PY{k}{import} \PY{n}{StandardScaler}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{feature} \PY{k}{import} \PY{n}{MinMaxScaler}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{linalg} \PY{k}{import} \PY{n}{Vectors}
          \PY{n}{va} \PY{o}{=} \PY{n}{feature}\PY{o}{.}\PY{n}{VectorAssembler}\PY{p}{(}\PY{n}{inputCols}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Morning}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Afternoon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Evening}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Winter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spring}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tuesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wednesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Friday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Saturday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ch}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VendorID\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}stdrate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}JFK}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Newark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Nassau\PYZus{}W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Negotiated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}temp\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Snow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}CCard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}cash}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}nocharge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}dispute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}voidtrip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{vec\PYZus{}df}\PY{o}{=} \PY{n}{va}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{data}\PY{p}{)}
          \PY{n}{scaler} \PY{o}{=} \PY{n}{MinMaxScaler}\PY{p}{(}\PY{n}{inputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scaledFeatures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n}{scalerModel} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{vec\PYZus{}df}\PY{p}{)}
          \PY{n}{scaled\PYZus{}df} \PY{o}{=} \PY{n}{scalerModel}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{vec\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{scaled\PYZus{}df}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}109}]:} ['Morning',
           'Afternoon',
           'Evening',
           'Fall',
           'Winter',
           'Spring',
           'Monday',
           'Tuesday',
           'Wednesday',
           'Thursday',
           'Friday',
           'Saturday',
           'Sunday',
           'dropoff\_cc',
           'dropoff\_GM',
           'dropoff\_ues',
           'dropoff\_Gvs',
           'dropoff\_Uws',
           'dropoff\_Les',
           'dropoff\_Lm',
           'dropoff\_Wq',
           'dropoff\_Nb',
           'dropoff\_ch',
           'Pickup\_cc',
           'Pickup\_GM',
           'Pickup\_ues',
           'Pickup\_Gvs',
           'Pickup\_Uws',
           'Pickup\_Les',
           'Pickup\_Lm',
           'Pickup\_Wq',
           'Pickup\_Nb',
           'Pickup\_Nq',
           'VendorID\_1\_0',
           'store\_and\_fwd\_flag\_1\_0',
           'RateCode\_stdrate',
           'RateCode\_JFK',
           'RateCode\_Newark',
           'RateCode\_Nassau\_W',
           'RateCode\_Negotiated',
           'RateCode\_Group',
           'avg\_temp\_C',
           'Rain',
           'Fog',
           'Snow',
           'Holiday',
           'pickup\_longitude',
           'pickup\_latitude',
           'dropoff\_longitude',
           'dropoff\_latitude',
           'total\_amount',
           'ptype\_CCard',
           'ptype\_cash',
           'ptype\_nocharge',
           'ptype\_dispute',
           'ptype\_voidtrip',
           'Duration',
           'features',
           'scaledFeatures']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{scaled\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}110}]:} 59
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{n}{scaled\PYZus{}df}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+------------------+------------------+-----------------+------------------+------------+-----------+----------+--------------+-------------+--------------+--------+--------------------+--------------------+
|Morning|Afternoon|Evening|Fall|Winter|Spring|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday|dropoff\_cc|dropoff\_GM|dropoff\_ues|dropoff\_Gvs|dropoff\_Uws|dropoff\_Les|dropoff\_Lm|dropoff\_Wq|dropoff\_Nb|dropoff\_ch|Pickup\_cc|Pickup\_GM|Pickup\_ues|Pickup\_Gvs|Pickup\_Uws|Pickup\_Les|Pickup\_Lm|Pickup\_Wq|Pickup\_Nb|Pickup\_Nq|VendorID\_1\_0|store\_and\_fwd\_flag\_1\_0|RateCode\_stdrate|RateCode\_JFK|RateCode\_Newark|RateCode\_Nassau\_W|RateCode\_Negotiated|RateCode\_Group|avg\_temp\_C|Rain|Fog|Snow|Holiday|  pickup\_longitude|   pickup\_latitude|dropoff\_longitude|  dropoff\_latitude|total\_amount|ptype\_CCard|ptype\_cash|ptype\_nocharge|ptype\_dispute|ptype\_voidtrip|Duration|            features|      scaledFeatures|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+------------------+------------------+-----------------+------------------+------------+-----------+----------+--------------+-------------+--------------+--------+--------------------+--------------------+
|      0|        0|      1|   0|     0|     1|     1|      0|        0|       0|     0|       0|     0|         1|         0|          0|          0|          0|          0|         0|         0|         0|         0|        1|        0|         0|         0|         0|         0|        0|        0|        0|        0|           1|                     0|               1|           0|              0|                0|                  0|             0|       161|   1|  0|   0|      0|-73.98040771484375|40.764930725097656|-73.9839859008789|40.759315490722656|         5.8|          0|         1|             0|            0|             0|     161|(55,[2,5,6,13,23,{\ldots}|[0.0,0.0,1.0,0.0,{\ldots}|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+------------------+------------------+-----------------+------------------+------------+-----------+----------+--------------+-------------+--------------+--------+--------------------+--------------------+
only showing top 1 row


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{c+c1}{\PYZsh{}SPLITTING:}
          \PY{c+c1}{\PYZsh{} splitting the scaled dataframe into training, validation and test dataframe}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{training\PYZus{}df\PYZus{}Dec5}\PY{p}{,} \PY{n}{validation\PYZus{}df\PYZus{}Dec5}\PY{p}{,} \PY{n}{testing\PYZus{}df\PYZus{}Dec5} \PY{o}{=} \PY{n}{scaled\PYZus{}df}\PY{o}{.}\PY{n}{randomSplit}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.6}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{c+c1}{\PYZsh{}training\PYZus{}df\PYZus{}Dec5.toPandas().to\PYZus{}csv(header=True, path\PYZus{}or\PYZus{}buf=\PYZsq{}/Users/apsharma/IST718 Dropbox/Final/training\PYZus{}df\PYZus{}Dec5.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{c+c1}{\PYZsh{}print(\PYZdq{}\PYZsh{} points in training: \PYZdq{}, training\PYZus{}df\PYZus{}Nov16.count()) }
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{c+c1}{\PYZsh{}validation\PYZus{}df\PYZus{}Dec5.toPandas().to\PYZus{}csv(header=True, path\PYZus{}or\PYZus{}buf=\PYZsq{}/Users/apsharma/IST718 Dropbox/Final/validation\PYZus{}df\PYZus{}Dec5.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{c+c1}{\PYZsh{}print(\PYZdq{}\PYZsh{} points in validation: \PYZdq{}, validation\PYZus{}df\PYZus{}Nov16.count()) }
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{c+c1}{\PYZsh{}testing\PYZus{}df\PYZus{}Dec5.toPandas().to\PYZus{}csv(header=True, path\PYZus{}or\PYZus{}buf=\PYZsq{}/Users/apsharma/IST718 Dropbox/Final/testing\PYZus{}df\PYZus{}Dec5.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{c+c1}{\PYZsh{}print(\PYZdq{}\PYZsh{} points in testing: \PYZdq{}, testing\PYZus{}df\PYZus{}Nov16.count()) }
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{n}{training\PYZus{}df} \PY{o}{=} \PY{n}{training\PYZus{}df\PYZus{}Dec5}
          \PY{n}{validation\PYZus{}df} \PY{o}{=} \PY{n}{validation\PYZus{}df\PYZus{}Dec5}
          \PY{n}{testing\PYZus{}df} \PY{o}{=} \PY{n}{testing\PYZus{}df\PYZus{}Dec5}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}MODELLING ANALYSIS \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{c+c1}{\PYZsh{}Linear Model:}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{c+c1}{\PYZsh{} 1) linear regression model for the total amount prediction\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{c+c1}{\PYZsh{} defining the linear regression model object}
          \PY{n}{linearmodel\PYZus{}amt} \PY{o}{=} \PY{n}{regression}\PY{o}{.}\PY{n}{LinearRegression}\PY{p}{(}\PY{n}{featuresCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaledFeatures}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{c+c1}{\PYZsh{} fit the model on the training data }
          \PY{n}{modellinear\PYZus{}amt} \PY{o}{=} \PY{n}{linearmodel\PYZus{}amt}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{c+c1}{\PYZsh{} transform the validation data}
          \PY{n}{predictionslinear} \PY{o}{=} \PY{n}{modellinear\PYZus{}amt}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{validation\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{c+c1}{\PYZsh{} calculate the rmse on the validation data}
          \PY{n}{rmse1\PYZus{}df\PYZus{}amt\PYZus{}linear} \PY{o}{=} \PY{n}{predictionslinear}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{sqrt}
                                          \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{sum}
                                           \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{pow}
                                            \PY{p}{(}\PY{n}{predictionslinear}\PY{o}{.}\PY{n}{prediction} \PY{o}{\PYZhy{}} \PY{n}{predictionslinear}\PY{o}{.}\PY{n}{total\PYZus{}amount}\PY{p}{,}
                                             \PY{n}{fn}\PY{o}{.}\PY{n}{lit}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
                                            \PY{p}{)}
                                           \PY{p}{)}
                                           \PY{o}{/}\PY{n}{predictionslinear}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
                                          \PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse\PYZus{}amt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{n}{rmse1\PYZus{}df\PYZus{}amt\PYZus{}linear}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-----------------+
|         rmse\_amt|
+-----------------+
|3.665235900726855|
+-----------------+


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{c+c1}{\PYZsh{} 2) random forest regression model for the total amount prediction}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}130}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{regression} \PY{k}{import} \PY{n}{RandomForestRegressor}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{feature} \PY{k}{import} \PY{n}{VectorIndexer}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{evaluation} \PY{k}{import} \PY{n}{RegressionEvaluator}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{regression} \PY{k}{import} \PY{n}{GBTRegressor}
          
          \PY{n}{randomf\PYZus{}amt} \PY{o}{=} \PY{n}{RandomForestRegressor}\PY{p}{(}\PY{n}{featuresCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaledFeatures}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{c+c1}{\PYZsh{} fit the model on the training data}
          
          \PY{n}{modelrandom\PYZus{}amt} \PY{o}{=} \PY{n}{randomf\PYZus{}amt}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}132}]:} \PY{c+c1}{\PYZsh{} transform the validation data}
          
          \PY{n}{predictionsrandom\PYZus{}amt} \PY{o}{=} \PY{n}{modelrandom\PYZus{}amt}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{validation\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{c+c1}{\PYZsh{} calculation of rmse on the validation data}
          \PY{n}{evaluatorrandom\PYZus{}amt} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{rmserandom\PYZus{}amt} \PY{o}{=} \PY{n}{evaluatorrandom\PYZus{}amt}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{predictionsrandom\PYZus{}amt}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Squared Error (RMSE) on validation = }\PY{l+s+si}{\PYZpc{}g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rmserandom\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Root Mean Squared Error (RMSE) on validation = 3.90161

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{c+c1}{\PYZsh{} gradient boosting regression model for the total amount prediction\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}135}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{regression} \PY{k}{import} \PY{n}{GBTRegressor}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{c+c1}{\PYZsh{} defining the gradient boosting object}
          \PY{n}{gbt\PYZus{}amt} \PY{o}{=} \PY{n}{GBTRegressor}\PY{p}{(}\PY{n}{featuresCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaledFeatures}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{maxIter}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}137}]:} \PY{c+c1}{\PYZsh{} fit the model on the training data}
          \PY{n}{modelgbt\PYZus{}amt} \PY{o}{=} \PY{n}{gbt\PYZus{}amt}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}138}]:} \PY{c+c1}{\PYZsh{} transform the validation data}
          \PY{n}{predictionsgbt\PYZus{}amt} \PY{o}{=} \PY{n}{modelgbt\PYZus{}amt}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{validation\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}139}]:} \PY{c+c1}{\PYZsh{} calculating the rmse on validation data}
          \PY{n}{evaluatorgbt} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{rmsegbt\PYZus{}amt} \PY{o}{=} \PY{n}{evaluatorgbt}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{predictionsgbt\PYZus{}amt}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Squared Error (RMSE) for total amount on validation data = }\PY{l+s+si}{\PYZpc{}g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rmsegbt\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Root Mean Squared Error (RMSE) for total amount on validation data = 3.31603

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{c+c1}{\PYZsh{} After removing target leakage contributing features and dropping correlated coluns,}
          \PY{c+c1}{\PYZsh{}the best model is the gradient boosting as per the given rmse values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{best\PYZus{}model\PYZus{}amt} \PY{o}{=} \PY{n}{modelgbt\PYZus{}amt}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{c+c1}{\PYZsh{} transform the testing data on the best model}
          \PY{n}{prediction\PYZus{}best} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}amt}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{testing\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{c+c1}{\PYZsh{} calculating the best\PYZus{}rmse on testing data}
          \PY{n}{evaluatorbest} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{rmsetest} \PY{o}{=} \PY{n}{evaluatorbest}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{prediction\PYZus{}best}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Squared Error (RMSE) on testing data = }\PY{l+s+si}{\PYZpc{}g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rmsetest}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Root Mean Squared Error (RMSE) on testing data = 3.01548

    \end{Verbatim}

    \#\#\# The best rmse for predicting the total amount on the testing data
is \$2.95069

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{c+c1}{\PYZsh{} predicting the duration based on three models \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{c+c1}{\PYZsh{} 1) linear model for predicting duration}
          
          \PY{n}{linearmodel\PYZus{}dura} \PY{o}{=} \PY{n}{regression}\PY{o}{.}\PY{n}{LinearRegression}\PY{p}{(}\PY{n}{featuresCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaledFeatures}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} \PY{n}{modellinear\PYZus{}dura} \PY{o}{=} \PY{n}{linearmodel\PYZus{}dura}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}147}]:} \PY{n}{predictionslinear\PYZus{}dura} \PY{o}{=} \PY{n}{modellinear\PYZus{}dura}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{validation\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}148}]:} \PY{n}{rmse1\PYZus{}df\PYZus{}dura} \PY{o}{=} \PY{n}{predictionslinear\PYZus{}dura}\PY{o}{.}\PY{n}{select}\PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{sqrt}
                                          \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{sum}
                                           \PY{p}{(}\PY{n}{fn}\PY{o}{.}\PY{n}{pow}
                                            \PY{p}{(}\PY{n}{predictionslinear\PYZus{}dura}\PY{o}{.}\PY{n}{prediction} \PY{o}{\PYZhy{}} \PY{n}{predictionslinear\PYZus{}dura}\PY{o}{.}\PY{n}{Duration}\PY{p}{,}
                                             \PY{n}{fn}\PY{o}{.}\PY{n}{lit}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
                                            \PY{p}{)}
                                           \PY{p}{)}
                                           \PY{o}{/}\PY{n}{predictionslinear\PYZus{}dura}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
                                          \PY{p}{)}\PY{o}{.}\PY{n}{alias}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse\PYZus{}dura}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}149}]:} \PY{n}{rmse1\PYZus{}df\PYZus{}dura}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------------------+
|          rmse\_dura|
+-------------------+
|0.01482460564774702|
+-------------------+


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}150}]:} \PY{c+c1}{\PYZsh{} 2) Random forest model for the trip duration prediction\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}151}]:} \PY{n}{randomf\PYZus{}dura} \PY{o}{=} \PY{n}{RandomForestRegressor}\PY{p}{(}\PY{n}{featuresCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaledFeatures}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}152}]:} \PY{n}{modelrandom\PYZus{}dura} \PY{o}{=} \PY{n}{randomf\PYZus{}dura}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}153}]:} \PY{n}{predictionsrandom\PYZus{}dura} \PY{o}{=} \PY{n}{modelrandom\PYZus{}dura}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{validation\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}154}]:} \PY{n}{evaluatorrandom\PYZus{}dura} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{rmserandom\PYZus{}dura} \PY{o}{=} \PY{n}{evaluatorrandom\PYZus{}dura}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{predictionsrandom\PYZus{}dura}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Squared Error (RMSE) of random forest on validation = }\PY{l+s+si}{\PYZpc{}g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rmserandom\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Root Mean Squared Error (RMSE) of random forest on validation = 166.27

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}155}]:} \PY{c+c1}{\PYZsh{} 3) Gradient Boosting model for the trip duration prediction\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}156}]:} \PY{n}{gbt\PYZus{}dura} \PY{o}{=} \PY{n}{GBTRegressor}\PY{p}{(}\PY{n}{featuresCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaledFeatures}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{maxIter}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}157}]:} \PY{n}{modelgbt\PYZus{}dura} \PY{o}{=} \PY{n}{gbt\PYZus{}dura}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{training\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}158}]:} \PY{n}{predictionsgbt\PYZus{}dura} \PY{o}{=} \PY{n}{modelgbt\PYZus{}dura}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{validation\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}159}]:} \PY{n}{evaluatorgbt\PYZus{}dura} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{rmsegbt\PYZus{}dura} \PY{o}{=} \PY{n}{evaluatorgbt\PYZus{}dura}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{predictionsgbt\PYZus{}dura}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Squared Error (RMSE) of GBT on validation data = }\PY{l+s+si}{\PYZpc{}g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rmsegbt\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Root Mean Squared Error (RMSE) of GBT on validation data = 104.476

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}160}]:} \PY{n}{best\PYZus{}model\PYZus{}dur} \PY{o}{=} \PY{n}{modelgbt\PYZus{}dura}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}161}]:} \PY{c+c1}{\PYZsh{} transform the testing data on the best model}
          \PY{n}{predictionsgbt\PYZus{}best\PYZus{}dur} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}dur}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{testing\PYZus{}df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}162}]:} \PY{c+c1}{\PYZsh{} calculating the best\PYZus{}rmse on testing data}
          \PY{n}{evaluatorgbt\PYZus{}best} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{rmsegbt\PYZus{}dur} \PY{o}{=} \PY{n}{evaluatorgbt\PYZus{}best}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{predictionsgbt\PYZus{}best\PYZus{}dur}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Squared Error (RMSE) on testing data = }\PY{l+s+si}{\PYZpc{}g}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rmsegbt\PYZus{}dur}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Root Mean Squared Error (RMSE) on testing data = 83.6365

    \end{Verbatim}

    \subparagraph{The best rmse for predicting the duration on the testing
data is 103
sec}\label{the-best-rmse-for-predicting-the-duration-on-the-testing-data-is-103-sec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}163}]:} \PY{c+c1}{\PYZsh{}Acuna Values:}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}164}]:} \PY{c+c1}{\PYZsh{}Predicting duration on Professor\PYZsq{}s hypothetical scenario:}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}165}]:} \PY{n}{acunavalues}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}
          \PY{l+m+mi}{2}\PY{p}{,}
          \PY{l+m+mi}{1}\PY{p}{,}
          \PY{l+m+mi}{0}\PY{p}{,}
          \PY{l+m+mi}{0}\PY{p}{,}
          \PY{l+m+mi}{1}\PY{p}{,}
          \PY{l+m+mf}{73.87}\PY{p}{,}
          \PY{l+m+mf}{40.77}\PY{p}{,}
          \PY{l+m+mf}{73.96}\PY{p}{,}
          \PY{l+m+mf}{40.78}\PY{p}{,}
          \PY{l+m+mi}{1}\PY{p}{,}
          \PY{l+m+mi}{0}\PY{p}{,}
          \PY{l+m+mi}{0}\PY{p}{,}
          \PY{l+m+mi}{0}\PY{p}{,}
          \PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}166}]:} \PY{c+c1}{\PYZsh{}Creating datafarme:}
          \PY{n}{xyz}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{acunavalues}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}167}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{xyz}\PY{p}{)}
          \PY{n}{xyz}\PY{o}{.}\PY{n}{T}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}167}]:}     0    1    2    3    4    5    6    7    8    9  {\ldots}    45     46     47  \textbackslash{}
          0  0.0  0.0  1.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0 {\ldots}   1.0  73.87  40.77   
          
                48     49   50   51   52   53   54  
          0  73.96  40.78  1.0  0.0  0.0  0.0  0.0  
          
          [1 rows x 55 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}168}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{xyz}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}168}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}169}]:} \PY{c+c1}{\PYZsh{}xyz}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}170}]:} \PY{n}{xyz1}\PY{o}{=}\PY{n}{xyz}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Morning}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Afternoon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Evening}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Winter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spring}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{7}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tuesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wednesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Friday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Saturday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{14}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{15}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{16}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{18}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{21}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{22}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ch}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{26}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{27}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{28}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{29}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{31}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VendorID\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{34}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}stdrate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}JFK}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{37}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Newark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{38}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Nassau\PYZus{}W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{39}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Negotiated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}temp\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{42}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{44}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Snow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{45}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{46}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{47}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{49}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
          \PY{l+m+mi}{50}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}CCard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}cash}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{52}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}nocharge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{53}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}dispute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{54}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}voidtrip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}171}]:} \PY{n}{xyz1}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{55}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}171}]:}                             0
          Morning                  0.00
          Afternoon                0.00
          Evening                  1.00
          Fall                     0.00
          Winter                   1.00
          Spring                   0.00
          Monday                   0.00
          Tuesday                  0.00
          Wednesday                0.00
          Thursday                 0.00
          Friday                   1.00
          Saturday                 0.00
          Sunday                   0.00
          dropoff\_cc               0.00
          dropoff\_GM               0.00
          dropoff\_ues              0.00
          dropoff\_Gvs              0.00
          dropoff\_Uws              0.00
          dropoff\_Les              0.00
          dropoff\_Lm               0.00
          dropoff\_Wq               1.00
          dropoff\_Nb               0.00
          dropoff\_ch               0.00
          Pickup\_cc                0.00
          Pickup\_GM                0.00
          Pickup\_ues               1.00
          Pickup\_Gvs               0.00
          Pickup\_Uws               0.00
          Pickup\_Les               0.00
          Pickup\_Lm                0.00
          Pickup\_Wq                1.00
          Pickup\_Nb                0.00
          Pickup\_Nq                0.00
          VendorID\_1\_0             0.00
          store\_and\_fwd\_flag\_1\_0   0.00
          RateCode\_stdrate         0.00
          RateCode\_JFK             1.00
          RateCode\_Newark          0.00
          RateCode\_Nassau\_W        0.00
          RateCode\_Negotiated      0.00
          RateCode\_Group           0.00
          avg\_temp\_C               2.00
          Rain                     1.00
          Fog                      0.00
          Snow                     0.00
          Holiday                  1.00
          pickup\_longitude        73.87
          pickup\_latitude         40.77
          dropoff\_longitude       73.96
          dropoff\_latitude        40.78
          ptype\_CCard              1.00
          ptype\_cash               0.00
          ptype\_nocharge           0.00
          ptype\_dispute            0.00
          ptype\_voidtrip           0.00
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}172}]:} \PY{n}{xyzspark}\PY{o}{=}\PY{n}{spark}\PY{o}{.}\PY{n}{createDataFrame}\PY{p}{(}\PY{n}{xyz1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}173}]:} \PY{n}{va3} \PY{o}{=} \PY{n}{feature}\PY{o}{.}\PY{n}{VectorAssembler}\PY{p}{(}\PY{n}{inputCols}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Morning}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Afternoon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Evening}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Winter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spring}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Monday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tuesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wednesday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thursday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Friday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Saturday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sunday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}ch}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}cc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}GM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}ues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Gvs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Uws}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Les}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Lm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Wq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pickup\PYZus{}Nq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VendorID\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{store\PYZus{}and\PYZus{}fwd\PYZus{}flag\PYZus{}1\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}stdrate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}JFK}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Newark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Nassau\PYZus{}W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Negotiated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RateCode\PYZus{}Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}temp\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fog}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Snow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickup\PYZus{}latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dropoff\PYZus{}latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}CCard}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}cash}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}nocharge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}dispute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ptype\PYZus{}voidtrip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{n}{outputCol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{vec\PYZus{}df3}\PY{o}{=} \PY{n}{va3}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{xyzspark}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}174}]:} \PY{n}{scaled\PYZus{}df\PYZus{}new} \PY{o}{=} \PY{n}{scalerModel}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{vec\PYZus{}df3}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}175}]:} \PY{n}{scaled\PYZus{}df\PYZus{}new}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+
|Morning|Afternoon|Evening|Fall|Winter|Spring|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday|dropoff\_cc|dropoff\_GM|dropoff\_ues|dropoff\_Gvs|dropoff\_Uws|dropoff\_Les|dropoff\_Lm|dropoff\_Wq|dropoff\_Nb|dropoff\_ch|Pickup\_cc|Pickup\_GM|Pickup\_ues|Pickup\_Gvs|Pickup\_Uws|Pickup\_Les|Pickup\_Lm|Pickup\_Wq|Pickup\_Nb|Pickup\_Nq|VendorID\_1\_0|store\_and\_fwd\_flag\_1\_0|RateCode\_stdrate|RateCode\_JFK|RateCode\_Newark|RateCode\_Nassau\_W|RateCode\_Negotiated|RateCode\_Group|avg\_temp\_C|Rain|Fog|Snow|Holiday|pickup\_longitude|pickup\_latitude|dropoff\_longitude|dropoff\_latitude|ptype\_CCard|ptype\_cash|ptype\_nocharge|ptype\_dispute|ptype\_voidtrip|            features|      scaledFeatures|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+
|    0.0|      0.0|    1.0| 0.0|   1.0|   0.0|   0.0|    0.0|      0.0|     0.0|   1.0|     0.0|   0.0|       0.0|       0.0|        0.0|        0.0|        0.0|        0.0|       0.0|       1.0|       0.0|       0.0|      0.0|      0.0|       1.0|       0.0|       0.0|       0.0|      0.0|      1.0|      0.0|      0.0|         0.0|                   0.0|             0.0|         1.0|            0.0|              0.0|                0.0|           0.0|       2.0| 1.0|0.0| 0.0|    1.0|           73.87|          40.77|            73.96|           40.78|        1.0|       0.0|           0.0|          0.0|           0.0|(55,[2,4,10,20,25{\ldots}|[0.0,0.0,1.0,0.0,{\ldots}|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}176}]:} \PY{n}{predictionsgbt\PYZus{}acuna} \PY{o}{=} \PY{n}{modelrandom\PYZus{}dura}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{scaled\PYZus{}df\PYZus{}new}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}177}]:} \PY{n}{predictionsgbt\PYZus{}acuna}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+-----------------+
|Morning|Afternoon|Evening|Fall|Winter|Spring|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday|dropoff\_cc|dropoff\_GM|dropoff\_ues|dropoff\_Gvs|dropoff\_Uws|dropoff\_Les|dropoff\_Lm|dropoff\_Wq|dropoff\_Nb|dropoff\_ch|Pickup\_cc|Pickup\_GM|Pickup\_ues|Pickup\_Gvs|Pickup\_Uws|Pickup\_Les|Pickup\_Lm|Pickup\_Wq|Pickup\_Nb|Pickup\_Nq|VendorID\_1\_0|store\_and\_fwd\_flag\_1\_0|RateCode\_stdrate|RateCode\_JFK|RateCode\_Newark|RateCode\_Nassau\_W|RateCode\_Negotiated|RateCode\_Group|avg\_temp\_C|Rain|Fog|Snow|Holiday|pickup\_longitude|pickup\_latitude|dropoff\_longitude|dropoff\_latitude|ptype\_CCard|ptype\_cash|ptype\_nocharge|ptype\_dispute|ptype\_voidtrip|            features|      scaledFeatures|       prediction|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+-----------------+
|    0.0|      0.0|    1.0| 0.0|   1.0|   0.0|   0.0|    0.0|      0.0|     0.0|   1.0|     0.0|   0.0|       0.0|       0.0|        0.0|        0.0|        0.0|        0.0|       0.0|       1.0|       0.0|       0.0|      0.0|      0.0|       1.0|       0.0|       0.0|       0.0|      0.0|      1.0|      0.0|      0.0|         0.0|                   0.0|             0.0|         1.0|            0.0|              0.0|                0.0|           0.0|       2.0| 1.0|0.0| 0.0|    1.0|           73.87|          40.77|            73.96|           40.78|        1.0|       0.0|           0.0|          0.0|           0.0|(55,[2,4,10,20,25{\ldots}|[0.0,0.0,1.0,0.0,{\ldots}|438.7822636011389|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+-----------------+


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}178}]:} \PY{c+c1}{\PYZsh{}Total Amount prediction:}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}179}]:} \PY{n}{predictionsrandom\PYZus{}amt\PYZus{}acuna} \PY{o}{=} \PY{n}{modelrandom\PYZus{}amt}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{scaled\PYZus{}df\PYZus{}new}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}180}]:} \PY{n}{predictionsrandom\PYZus{}amt\PYZus{}acuna}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+-----------------+
|Morning|Afternoon|Evening|Fall|Winter|Spring|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday|dropoff\_cc|dropoff\_GM|dropoff\_ues|dropoff\_Gvs|dropoff\_Uws|dropoff\_Les|dropoff\_Lm|dropoff\_Wq|dropoff\_Nb|dropoff\_ch|Pickup\_cc|Pickup\_GM|Pickup\_ues|Pickup\_Gvs|Pickup\_Uws|Pickup\_Les|Pickup\_Lm|Pickup\_Wq|Pickup\_Nb|Pickup\_Nq|VendorID\_1\_0|store\_and\_fwd\_flag\_1\_0|RateCode\_stdrate|RateCode\_JFK|RateCode\_Newark|RateCode\_Nassau\_W|RateCode\_Negotiated|RateCode\_Group|avg\_temp\_C|Rain|Fog|Snow|Holiday|pickup\_longitude|pickup\_latitude|dropoff\_longitude|dropoff\_latitude|ptype\_CCard|ptype\_cash|ptype\_nocharge|ptype\_dispute|ptype\_voidtrip|            features|      scaledFeatures|       prediction|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+-----------------+
|    0.0|      0.0|    1.0| 0.0|   1.0|   0.0|   0.0|    0.0|      0.0|     0.0|   1.0|     0.0|   0.0|       0.0|       0.0|        0.0|        0.0|        0.0|        0.0|       0.0|       1.0|       0.0|       0.0|      0.0|      0.0|       1.0|       0.0|       0.0|       0.0|      0.0|      1.0|      0.0|      0.0|         0.0|                   0.0|             0.0|         1.0|            0.0|              0.0|                0.0|           0.0|       2.0| 1.0|0.0| 0.0|    1.0|           73.87|          40.77|            73.96|           40.78|        1.0|       0.0|           0.0|          0.0|           0.0|(55,[2,4,10,20,25{\ldots}|[0.0,0.0,1.0,0.0,{\ldots}|33.18474478011039|
+-------+---------+-------+----+------+------+------+-------+---------+--------+------+--------+------+----------+----------+-----------+-----------+-----------+-----------+----------+----------+----------+----------+---------+---------+----------+----------+----------+----------+---------+---------+---------+---------+------------+----------------------+----------------+------------+---------------+-----------------+-------------------+--------------+----------+----+---+----+-------+----------------+---------------+-----------------+----------------+-----------+----------+--------------+-------------+--------------+--------------------+--------------------+-----------------+


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}181}]:} \PY{c+c1}{\PYZsh{}Predicted Time duration for Professor Acuna\PYZsq{}s trip: 601 seconds}
          \PY{c+c1}{\PYZsh{}Predicted Fare for Professor Acuna\PYZsq{}s trip: \PYZdl{} 35.141 }
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}182}]:} \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}XGB\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}183}]:} \PY{c+c1}{\PYZsh{} XG Boosting Model and feature importance}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}184}]:} \PY{c+c1}{\PYZsh{} 1) XG boost and important features for total amount}
          \PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}185}]:} \PY{k+kn}{import} \PY{n+nn}{os}
          
          \PY{k+kn}{import} \PY{n+nn}{findspark}
          \PY{n}{findspark}\PY{o}{.}\PY{n}{init}\PY{p}{(}\PY{p}{)}
          
          \PY{k+kn}{import} \PY{n+nn}{pyspark}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql}\PY{n+nn}{.}\PY{n+nn}{session} \PY{k}{import} \PY{n}{SparkSession}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql}\PY{n+nn}{.}\PY{n+nn}{types} \PY{k}{import} \PY{o}{*}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{feature} \PY{k}{import} \PY{n}{StringIndexer}\PY{p}{,} \PY{n}{VectorAssembler}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml} \PY{k}{import} \PY{n}{Pipeline}
          \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{sql}\PY{n+nn}{.}\PY{n+nn}{functions} \PY{k}{import} \PY{n}{col}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}186}]:} \PY{n}{spark}\PY{o}{.}\PY{n}{sparkContext}\PY{o}{.}\PY{n}{addPyFile}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Users/apsharma/Downloads/sparkxgb.zip}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}187}]:} \PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}188}]:} \PY{k+kn}{from} \PY{n+nn}{sparkxgb} \PY{k}{import} \PY{n}{XGBoostEstimator}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}189}]:} \PY{k+kn}{import} \PY{n+nn}{os}
          \PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PYSPARK\PYZus{}SUBMIT\PYZus{}ARGS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}jars /Users/apsharma/Downloads/xgboost4j\PYZhy{}spark\PYZhy{}0.81.jar,/Users/apsharma/Downloads/xgboost4j\PYZhy{}0.81.jar pyspark\PYZhy{}shell}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}190}]:} \PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k}{import} \PY{n}{loadtxt}
          \PY{k+kn}{from} \PY{n+nn}{xgboost} \PY{k}{import} \PY{n}{XGBClassifier}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}191}]:} \PY{n}{scaled\PYZus{}df}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}191}]:} ['Morning',
           'Afternoon',
           'Evening',
           'Fall',
           'Winter',
           'Spring',
           'Monday',
           'Tuesday',
           'Wednesday',
           'Thursday',
           'Friday',
           'Saturday',
           'Sunday',
           'dropoff\_cc',
           'dropoff\_GM',
           'dropoff\_ues',
           'dropoff\_Gvs',
           'dropoff\_Uws',
           'dropoff\_Les',
           'dropoff\_Lm',
           'dropoff\_Wq',
           'dropoff\_Nb',
           'dropoff\_ch',
           'Pickup\_cc',
           'Pickup\_GM',
           'Pickup\_ues',
           'Pickup\_Gvs',
           'Pickup\_Uws',
           'Pickup\_Les',
           'Pickup\_Lm',
           'Pickup\_Wq',
           'Pickup\_Nb',
           'Pickup\_Nq',
           'VendorID\_1\_0',
           'store\_and\_fwd\_flag\_1\_0',
           'RateCode\_stdrate',
           'RateCode\_JFK',
           'RateCode\_Newark',
           'RateCode\_Nassau\_W',
           'RateCode\_Negotiated',
           'RateCode\_Group',
           'avg\_temp\_C',
           'Rain',
           'Fog',
           'Snow',
           'Holiday',
           'pickup\_longitude',
           'pickup\_latitude',
           'dropoff\_longitude',
           'dropoff\_latitude',
           'total\_amount',
           'ptype\_CCard',
           'ptype\_cash',
           'ptype\_nocharge',
           'ptype\_dispute',
           'ptype\_voidtrip',
           'Duration',
           'features',
           'scaledFeatures']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}192}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas} \PY{o}{=} \PY{n}{scaled\PYZus{}df}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}193}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandasnew} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}194}]:} \PY{n}{scaled\PYZus{}df\PYZus{}numpy} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}Pandasnew}\PY{o}{.}\PY{n}{values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}195}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}195}]:} Index(['Morning', 'Afternoon', 'Evening', 'Fall', 'Winter', 'Spring', 'Monday',
                 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday',
                 'dropoff\_cc', 'dropoff\_GM', 'dropoff\_ues', 'dropoff\_Gvs', 'dropoff\_Uws',
                 'dropoff\_Les', 'dropoff\_Lm', 'dropoff\_Wq', 'dropoff\_Nb', 'dropoff\_ch',
                 'Pickup\_cc', 'Pickup\_GM', 'Pickup\_ues', 'Pickup\_Gvs', 'Pickup\_Uws',
                 'Pickup\_Les', 'Pickup\_Lm', 'Pickup\_Wq', 'Pickup\_Nb', 'Pickup\_Nq',
                 'VendorID\_1\_0', 'store\_and\_fwd\_flag\_1\_0', 'RateCode\_stdrate',
                 'RateCode\_JFK', 'RateCode\_Newark', 'RateCode\_Nassau\_W',
                 'RateCode\_Negotiated', 'RateCode\_Group', 'avg\_temp\_C', 'Rain', 'Fog',
                 'Snow', 'Holiday', 'pickup\_longitude', 'pickup\_latitude',
                 'dropoff\_longitude', 'dropoff\_latitude', 'total\_amount', 'ptype\_CCard',
                 'ptype\_cash', 'ptype\_nocharge', 'ptype\_dispute', 'ptype\_voidtrip',
                 'Duration', 'features', 'scaledFeatures'],
                dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}196}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}196}]:} 59
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}197}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas\PYZus{}Amt} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}198}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{get\PYZus{}loc}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}198}]:} 50
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}199}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas\PYZus{}np}\PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}200}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas\PYZus{}np}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}200}]:} array([[0, 0, 1, {\ldots}, 161,
                  SparseVector(55, \{2: 1.0, 5: 1.0, 6: 1.0, 13: 1.0, 23: 1.0, 33: 1.0, 35: 1.0, 41: 161.0, 42: 1.0, 46: -73.9804, 47: 40.7649, 48: -73.984, 49: 40.7593, 51: 1.0\}),
                  DenseVector([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0141, 1.0, 0.0, 0.0, 0.0, 0.3003, 0.5937, 0.3925, 0.5795, 0.0, 1.0, 0.0, 0.0, 0.5])],
                 [0, 0, 0, {\ldots}, 2115,
                  SparseVector(55, \{5: 1.0, 6: 1.0, 23: 1.0, 35: 1.0, 41: 2115.0, 42: 1.0, 46: -73.9961, 47: 40.7382, 48: -74.0029, 49: 40.6248, 51: 1.0\}),
                  DenseVector([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.2899, 1.0, 0.0, 0.0, 0.0, 0.2562, 0.5054, 0.3514, 0.204, 0.0, 1.0, 0.0, 0.0, 0.5])],
                 [0, 1, 0, {\ldots}, 248,
                  SparseVector(55, \{1: 1.0, 5: 1.0, 6: 1.0, 13: 1.0, 23: 1.0, 35: 1.0, 41: 248.0, 42: 1.0, 46: -73.9922, 47: 40.7484, 48: -74.0039, 49: 40.7428, 51: 1.0\}),
                  DenseVector([0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0264, 1.0, 0.0, 0.0, 0.0, 0.2673, 0.5392, 0.3491, 0.5334, 0.0, 1.0, 0.0, 0.0, 0.5])],
                 {\ldots},
                 [1, 0, 0, {\ldots}, 422,
                  SparseVector(55, \{0: 1.0, 8: 1.0, 13: 1.0, 23: 1.0, 35: 1.0, 41: 422.0, 46: -73.9872, 47: 40.7609, 48: -74.0041, 49: 40.7429, 50: 1.0\}),
                  DenseVector([1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.051, 0.0, 0.0, 0.0, 0.0, 0.2814, 0.5805, 0.3488, 0.5336, 1.0, 0.0, 0.0, 0.0, 0.5])],
                 [0, 0, 0, {\ldots}, 2099,
                  SparseVector(55, \{8: 1.0, 13: 1.0, 23: 1.0, 33: 1.0, 35: 1.0, 41: 2099.0, 46: -73.989, 47: 40.7541, 48: -73.9798, 49: 40.666, 51: 1.0\}),
                  DenseVector([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.2876, 0.0, 0.0, 0.0, 0.0, 0.2761, 0.558, 0.4017, 0.319, 0.0, 1.0, 0.0, 0.0, 0.5])],
                 [0, 0, 0, {\ldots}, 334,
                  SparseVector(55, \{8: 1.0, 17: 1.0, 27: 1.0, 35: 1.0, 41: 334.0, 46: -73.9755, 47: 40.7896, 48: -73.9596, 49: 40.7797, 51: 1.0\}),
                  DenseVector([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0385, 0.0, 0.0, 0.0, 0.0, 0.3141, 0.6752, 0.4458, 0.6365, 0.0, 1.0, 0.0, 0.0, 0.5])]],
                dtype=object)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}201}]:} \PY{c+c1}{\PYZsh{} split data into X and y}
          \PY{n}{X} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas\PYZus{}np}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{49}\PY{p}{]}
          \PY{n}{Y} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas\PYZus{}np}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{49}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}202}]:} \PY{n}{Y}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}202}]:} array([40.759315490722656, 40.62480163574219, 40.742774963378906, {\ldots},
                 40.74285507202149, 40.66598129272461, 40.779727935791016],
                dtype=object)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}203}]:} \PY{c+c1}{\PYZsh{} split data into train and test sets}
          \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{7}
          \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.33}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{n}{test\PYZus{}size}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{seed}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}204}]:} \PY{c+c1}{\PYZsh{} fit model on training data}
          \PY{n}{model\PYZus{}amt} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{base\PYZus{}score}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{booster}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gbtree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{colsample\PYZus{}bylevel}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                 \PY{n}{colsample\PYZus{}bytree}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{gamma}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{max\PYZus{}delta\PYZus{}step}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                 \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{min\PYZus{}child\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{missing}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,}
                 \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{nthread}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                 \PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{scale\PYZus{}pos\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                 \PY{n}{silent}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{subsample}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{model\PYZus{}amt}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}204}]:} XGBRegressor(base\_score=0.5, booster='gbtree', colsample\_bylevel=1,
                 colsample\_bytree=1, gamma=0, learning\_rate=0.5, max\_delta\_step=0,
                 max\_depth=3, min\_child\_weight=1, missing=None, n\_estimators=100,
                 n\_jobs=1, nthread=None, objective='reg:linear', random\_state=0,
                 reg\_alpha=0, reg\_lambda=1, scale\_pos\_weight=1, seed=None,
                 silent=True, subsample=1)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}205}]:} \PY{c+c1}{\PYZsh{} make predictions for test data}
          \PY{n}{y\PYZus{}pred\PYZus{}amt} \PY{o}{=} \PY{n}{model\PYZus{}amt}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{predictions\PYZus{}amt} \PY{o}{=} \PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{value}\PY{p}{)} \PY{k}{for} \PY{n}{value} \PY{o+ow}{in} \PY{n}{y\PYZus{}pred\PYZus{}amt}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}206}]:} \PY{c+c1}{\PYZsh{}evaluate predictions}
          \PY{c+c1}{\PYZsh{}accuracy = accuracy\PYZus{}score(y\PYZus{}test, predictions\PYZus{}amt)}
          \PY{c+c1}{\PYZsh{}print(\PYZdq{}Accuracy: \PYZpc{}.2f\PYZpc{}\PYZpc{}\PYZdq{} \PYZpc{} (accuracy * 100.0))}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}207}]:} \PY{c+c1}{\PYZsh{}Accuracy: 77.95\PYZpc{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}208}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}amt}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[0.02028081 0.01560062 0.01092044 0.00624025 0.00468019 0.00312012
 0.00312012 0.00312012 0.00312012 0.00312012 0.00468019 0.00156006
 0.00936037 0.00624025 0.00936037 0.00468019 0.00780031 0.00780031
 0.00936037 0.01092044 0.01404056 0.00780031 0.         0.01404056
 0.00936037 0.00468019 0.01716069 0.00468019 0.00936037 0.00312012
 0.00468019 0.00312012 0.00312012 0.         0.00156006 0.00156006
 0.         0.         0.         0.         0.         0.20436817
 0.00156006 0.00156006 0.00156006 0.         0.10920437 0.15132606
 0.28705147]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}209}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{model\PYZus{}amt}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{model\PYZus{}amt}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_232_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}210}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{pyplot}
          \PY{c+c1}{\PYZsh{} plot feature importance using built\PYZhy{}in function}
          \PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k}{import} \PY{n}{loadtxt}
          \PY{k+kn}{from} \PY{n+nn}{xgboost} \PY{k}{import} \PY{n}{plot\PYZus{}importance}
          \PY{n}{plot\PYZus{}importance}\PY{p}{(}\PY{n}{model\PYZus{}amt}\PY{p}{)}
          \PY{n}{pyplot}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_233_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}211}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandasnew}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{48}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}211}]:} 'dropoff\_longitude'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}212}]:} \PY{n}{feature\PYZus{}array\PYZus{}amt} \PY{o}{=} \PY{n}{model\PYZus{}amt}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}213}]:} \PY{n}{feature\PYZus{}array\PYZus{}amt}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}213}]:} array([0.02028081, 0.01560062, 0.01092044, 0.00624025, 0.00468019,
                 0.00312012, 0.00312012, 0.00312012, 0.00312012, 0.00312012,
                 0.00468019, 0.00156006, 0.00936037, 0.00624025, 0.00936037,
                 0.00468019, 0.00780031, 0.00780031, 0.00936037, 0.01092044,
                 0.01404056, 0.00780031, 0.        , 0.01404056, 0.00936037,
                 0.00468019, 0.01716069, 0.00468019, 0.00936037, 0.00312012,
                 0.00468019, 0.00312012, 0.00312012, 0.        , 0.00156006,
                 0.00156006, 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.20436817, 0.00156006, 0.00156006, 0.00156006,
                 0.        , 0.10920437, 0.15132606, 0.28705147], dtype=float32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}214}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}array\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}214}]:} 49
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}215}]:} \PY{n}{feature\PYZus{}array\PYZus{}sorted\PYZus{}amt} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{feature\PYZus{}array\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}216}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{feature\PYZus{}array\PYZus{}sorted\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[0.28705147 0.20436817 0.15132606 0.10920437 0.02028081 0.01716069
 0.01560062 0.01404056 0.01404056 0.01092044 0.01092044 0.00936037
 0.00936037 0.00936037 0.00936037 0.00936037 0.00780031 0.00780031
 0.00780031 0.00624025 0.00624025 0.00468019 0.00468019 0.00468019
 0.00468019 0.00468019 0.00468019 0.00312012 0.00312012 0.00312012
 0.00312012 0.00312012 0.00312012 0.00312012 0.00312012 0.00156006
 0.00156006 0.00156006 0.00156006 0.00156006 0.00156006 0.
 0.         0.         0.         0.         0.         0.
 0.        ]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}217}]:} \PY{n}{feature\PYZus{}array\PYZus{}sorted\PYZus{}amt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{15}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}217}]:} array([0.28705147, 0.20436817, 0.15132606, 0.10920437, 0.02028081,
                 0.01716069, 0.01560062, 0.01404056, 0.01404056, 0.01092044,
                 0.01092044, 0.00936037, 0.00936037, 0.00936037, 0.00936037],
                dtype=float32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}218}]:} \PY{n}{feature\PYZus{}importance\PYZus{}amt} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{scaled\PYZus{}df\PYZus{}Pandasnew}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{62}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}array\PYZus{}amt}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                      \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}219}]:} \PY{n}{feature\PYZus{}importance\PYZus{}amt}
          \PY{c+c1}{\PYZsh{}Most important features for predicting Total Amount}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}219}]:}                    feature  importance
          48       dropoff\_longitude    0.287051
          41              avg\_temp\_C    0.204368
          47         pickup\_latitude    0.151326
          46        pickup\_longitude    0.109204
          0                  Morning    0.020281
          26              Pickup\_Gvs    0.017161
          1                Afternoon    0.015601
          23               Pickup\_cc    0.014041
          20              dropoff\_Wq    0.014041
          2                  Evening    0.010920
          19              dropoff\_Lm    0.010920
          18             dropoff\_Les    0.009360
          24               Pickup\_GM    0.009360
          12                  Sunday    0.009360
          28              Pickup\_Les    0.009360
          14              dropoff\_GM    0.009360
          16             dropoff\_Gvs    0.007800
          17             dropoff\_Uws    0.007800
          21              dropoff\_Nb    0.007800
          13              dropoff\_cc    0.006240
          3                     Fall    0.006240
          30               Pickup\_Wq    0.004680
          4                   Winter    0.004680
          25              Pickup\_ues    0.004680
          27              Pickup\_Uws    0.004680
          15             dropoff\_ues    0.004680
          10                  Friday    0.004680
          5                   Spring    0.003120
          31               Pickup\_Nb    0.003120
          8                Wednesday    0.003120
          32               Pickup\_Nq    0.003120
          7                  Tuesday    0.003120
          29               Pickup\_Lm    0.003120
          6                   Monday    0.003120
          9                 Thursday    0.003120
          42                    Rain    0.001560
          34  store\_and\_fwd\_flag\_1\_0    0.001560
          35        RateCode\_stdrate    0.001560
          11                Saturday    0.001560
          44                    Snow    0.001560
          43                     Fog    0.001560
          45                 Holiday    0.000000
          22              dropoff\_ch    0.000000
          40          RateCode\_Group    0.000000
          39     RateCode\_Negotiated    0.000000
          38       RateCode\_Nassau\_W    0.000000
          36            RateCode\_JFK    0.000000
          33            VendorID\_1\_0    0.000000
          37         RateCode\_Newark    0.000000
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}220}]:} \PY{c+c1}{\PYZsh{}XG Bosst and feature importance for duration}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}221}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}221}]:} 59
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}222}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{get\PYZus{}loc}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}222}]:} 56
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}223}]:} \PY{c+c1}{\PYZsh{} split data into X and y}
          \PY{n}{X} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}numpy}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{56}\PY{p}{]}
          \PY{n}{Y} \PY{o}{=} \PY{n}{scaled\PYZus{}df\PYZus{}numpy}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{56}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}224}]:} \PY{n}{Y}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}224}]:} array([161, 2115, 248, {\ldots}, 422, 2099, 334], dtype=object)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}225}]:} \PY{c+c1}{\PYZsh{} split data into train and test sets}
          \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{7}
          \PY{n}{test\PYZus{}size} \PY{o}{=} \PY{l+m+mf}{0.33}
          \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{n}{test\PYZus{}size}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{seed}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}226}]:} \PY{c+c1}{\PYZsh{} fit model on training data}
          \PY{n}{model\PYZus{}dura} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{base\PYZus{}score}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{booster}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gbtree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{colsample\PYZus{}bylevel}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                 \PY{n}{colsample\PYZus{}bytree}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{gamma}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{max\PYZus{}delta\PYZus{}step}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                 \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{min\PYZus{}child\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{missing}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,}
                 \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{nthread}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                 \PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{scale\PYZus{}pos\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                 \PY{n}{silent}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{subsample}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{model\PYZus{}dura}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}226}]:} XGBRegressor(base\_score=0.5, booster='gbtree', colsample\_bylevel=1,
                 colsample\_bytree=1, gamma=0, learning\_rate=0.3, max\_delta\_step=0,
                 max\_depth=3, min\_child\_weight=1, missing=None, n\_estimators=1000,
                 n\_jobs=1, nthread=None, objective='reg:linear', random\_state=0,
                 reg\_alpha=0, reg\_lambda=1, scale\_pos\_weight=1, seed=None,
                 silent=True, subsample=1)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}227}]:} \PY{c+c1}{\PYZsh{} make predictions for test data}
          \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model\PYZus{}dura}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          \PY{n}{predictions\PYZus{}dura} \PY{o}{=} \PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{value}\PY{p}{)} \PY{k}{for} \PY{n}{value} \PY{o+ow}{in} \PY{n}{y\PYZus{}pred}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}228}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} evaluate predictions}
          \PY{c+c1}{\PYZsh{} accuracy\PYZus{}dura = accuracy\PYZus{}score(y\PYZus{}test, predictions\PYZus{}dura)}
          \PY{c+c1}{\PYZsh{} print(\PYZdq{}Accuracy: \PYZpc{}.2f\PYZpc{}\PYZpc{}\PYZdq{} \PYZpc{} (accuracy\PYZus{}dura * 100.0))}
          \PY{c+c1}{\PYZsh{}Accuracy for Duration: 63.9\PYZpc{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}229}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}dura}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[3.5304502e-03 3.5304502e-03 2.5007355e-03 3.6775523e-03 2.2065314e-03
 2.7949398e-03 2.0594292e-03 2.3536335e-03 4.5601646e-03 2.3536335e-03
 2.6478376e-03 4.4130627e-04 2.3536335e-03 4.4130627e-04 8.8261254e-04
 5.8840838e-04 4.4130627e-04 1.4710210e-04 8.8261254e-04 2.9420419e-04
 7.3551043e-04 0.0000000e+00 0.0000000e+00 4.4130627e-04 5.8840838e-04
 2.9420419e-04 1.6181230e-03 1.4710210e-04 4.4130627e-04 4.4130627e-04
 4.4130627e-04 0.0000000e+00 7.3551043e-04 2.0594292e-03 5.8840838e-04
 1.4710210e-04 1.4710210e-04 0.0000000e+00 0.0000000e+00 4.4130627e-04
 0.0000000e+00 7.7993530e-01 1.6181230e-03 8.8261254e-04 5.8840838e-04
 0.0000000e+00 3.3392172e-02 2.8096499e-02 2.9567519e-02 4.2512503e-02
 3.3833481e-02 4.4130627e-04 5.8840838e-04 4.4130627e-04 1.4710210e-04
 0.0000000e+00]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}230}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{model\PYZus{}dura}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{model\PYZus{}dura}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_253_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}231}]:} \PY{c+c1}{\PYZsh{} plot feature importance using built\PYZhy{}in function}
          \PY{k+kn}{from} \PY{n+nn}{numpy} \PY{k}{import} \PY{n}{loadtxt}
          \PY{k+kn}{from} \PY{n+nn}{xgboost} \PY{k}{import} \PY{n}{plot\PYZus{}importance}
          \PY{n}{plot\PYZus{}importance}\PY{p}{(}\PY{n}{model\PYZus{}dura}\PY{p}{)}
          \PY{n}{pyplot}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_254_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}232}]:} \PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{48}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}232}]:} 'dropoff\_longitude'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}233}]:} \PY{n}{feature\PYZus{}array\PYZus{}dura} \PY{o}{=} \PY{n}{model\PYZus{}dura}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}234}]:} \PY{n}{feature\PYZus{}array\PYZus{}dura}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}234}]:} array([3.5304502e-03, 3.5304502e-03, 2.5007355e-03, 3.6775523e-03,
                 2.2065314e-03, 2.7949398e-03, 2.0594292e-03, 2.3536335e-03,
                 4.5601646e-03, 2.3536335e-03, 2.6478376e-03, 4.4130627e-04,
                 2.3536335e-03, 4.4130627e-04, 8.8261254e-04, 5.8840838e-04,
                 4.4130627e-04, 1.4710210e-04, 8.8261254e-04, 2.9420419e-04,
                 7.3551043e-04, 0.0000000e+00, 0.0000000e+00, 4.4130627e-04,
                 5.8840838e-04, 2.9420419e-04, 1.6181230e-03, 1.4710210e-04,
                 4.4130627e-04, 4.4130627e-04, 4.4130627e-04, 0.0000000e+00,
                 7.3551043e-04, 2.0594292e-03, 5.8840838e-04, 1.4710210e-04,
                 1.4710210e-04, 0.0000000e+00, 0.0000000e+00, 4.4130627e-04,
                 0.0000000e+00, 7.7993530e-01, 1.6181230e-03, 8.8261254e-04,
                 5.8840838e-04, 0.0000000e+00, 3.3392172e-02, 2.8096499e-02,
                 2.9567519e-02, 4.2512503e-02, 3.3833481e-02, 4.4130627e-04,
                 5.8840838e-04, 4.4130627e-04, 1.4710210e-04, 0.0000000e+00],
                dtype=float32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}235}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{feature\PYZus{}array\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}235}]:} 56
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}236}]:} \PY{n}{feature\PYZus{}array\PYZus{}sorted\PYZus{}dura} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{feature\PYZus{}array\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}237}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{feature\PYZus{}array\PYZus{}sorted\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[7.7993530e-01 4.2512503e-02 3.3833481e-02 3.3392172e-02 2.9567519e-02
 2.8096499e-02 4.5601646e-03 3.6775523e-03 3.5304502e-03 3.5304502e-03
 2.7949398e-03 2.6478376e-03 2.5007355e-03 2.3536335e-03 2.3536335e-03
 2.3536335e-03 2.2065314e-03 2.0594292e-03 2.0594292e-03 1.6181230e-03
 1.6181230e-03 8.8261254e-04 8.8261254e-04 8.8261254e-04 7.3551043e-04
 7.3551043e-04 5.8840838e-04 5.8840838e-04 5.8840838e-04 5.8840838e-04
 5.8840838e-04 4.4130627e-04 4.4130627e-04 4.4130627e-04 4.4130627e-04
 4.4130627e-04 4.4130627e-04 4.4130627e-04 4.4130627e-04 4.4130627e-04
 4.4130627e-04 2.9420419e-04 2.9420419e-04 1.4710210e-04 1.4710210e-04
 1.4710210e-04 1.4710210e-04 1.4710210e-04 0.0000000e+00 0.0000000e+00
 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
 0.0000000e+00]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}238}]:} \PY{n}{feature\PYZus{}array\PYZus{}sorted\PYZus{}dura}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{15}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}238}]:} array([0.7799353 , 0.0425125 , 0.03383348, 0.03339217, 0.02956752,
                 0.0280965 , 0.00456016, 0.00367755, 0.00353045, 0.00353045,
                 0.00279494, 0.00264784, 0.00250074, 0.00235363, 0.00235363],
                dtype=float32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}239}]:} \PY{n}{feature\PYZus{}importance\PYZus{}dura} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{scaled\PYZus{}df\PYZus{}Pandas}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{58}\PY{p}{]}\PY{p}{,}\PY{n}{feature\PYZus{}array\PYZus{}dura}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                      \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}240}]:} \PY{c+c1}{\PYZsh{}Most important features for predicting Duration}
          \PY{n}{feature\PYZus{}importance\PYZus{}dura}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}240}]:}                    feature  importance
          41              avg\_temp\_C    0.779935
          49        dropoff\_latitude    0.042513
          50            total\_amount    0.033833
          46        pickup\_longitude    0.033392
          48       dropoff\_longitude    0.029568
          47         pickup\_latitude    0.028096
          8                Wednesday    0.004560
          3                     Fall    0.003678
          1                Afternoon    0.003530
          0                  Morning    0.003530
          5                   Spring    0.002795
          10                  Friday    0.002648
          2                  Evening    0.002501
          9                 Thursday    0.002354
          12                  Sunday    0.002354
          7                  Tuesday    0.002354
          4                   Winter    0.002207
          6                   Monday    0.002059
          33            VendorID\_1\_0    0.002059
          26              Pickup\_Gvs    0.001618
          42                    Rain    0.001618
          18             dropoff\_Les    0.000883
          43                     Fog    0.000883
          14              dropoff\_GM    0.000883
          20              dropoff\_Wq    0.000736
          32               Pickup\_Nq    0.000736
          34  store\_and\_fwd\_flag\_1\_0    0.000588
          15             dropoff\_ues    0.000588
          24               Pickup\_GM    0.000588
          44                    Snow    0.000588
          52              ptype\_cash    0.000588
          51             ptype\_CCard    0.000441
          53          ptype\_nocharge    0.000441
          39     RateCode\_Negotiated    0.000441
          28              Pickup\_Les    0.000441
          11                Saturday    0.000441
          13              dropoff\_cc    0.000441
          16             dropoff\_Gvs    0.000441
          30               Pickup\_Wq    0.000441
          29               Pickup\_Lm    0.000441
          23               Pickup\_cc    0.000441
          19              dropoff\_Lm    0.000294
          25              Pickup\_ues    0.000294
          35        RateCode\_stdrate    0.000147
          54           ptype\_dispute    0.000147
          27              Pickup\_Uws    0.000147
          36            RateCode\_JFK    0.000147
          17             dropoff\_Uws    0.000147
          45                 Holiday    0.000000
          21              dropoff\_Nb    0.000000
          22              dropoff\_ch    0.000000
          40          RateCode\_Group    0.000000
          31               Pickup\_Nb    0.000000
          38       RateCode\_Nassau\_W    0.000000
          37         RateCode\_Newark    0.000000
          55          ptype\_voidtrip    0.000000
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}241}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}Model Comparison:\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}242}]:} \PY{c+c1}{\PYZsh{}1)Trip Duration\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}243}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{rmsegbt\PYZus{}dur}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}243}]:} float
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}244}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{rmserandom\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}244}]:} float
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}245}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{rmse1\PYZus{}df\PYZus{}dura}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}245}]:} pyspark.sql.dataframe.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}246}]:} \PY{c+c1}{\PYZsh{}result}
          \PY{n}{pdrmse\PYZus{}dura}\PY{o}{=}\PY{n}{rmse1\PYZus{}df\PYZus{}dura}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}247}]:} \PY{n}{pdrmse\PYZus{}dura}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}247}]:}    rmse\_dura
          0   0.014825
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}248}]:} \PY{n}{value\PYZus{}dura}\PY{o}{=} \PY{n}{pdrmse\PYZus{}dura}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}249}]:} \PY{n}{value\PYZus{}dura}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}249}]:} 0.01482460564774702
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}250}]:} \PY{n}{regression\PYZus{}dura} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Linear Regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Random Forest}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gradient Boosting Regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{p}{[}\PY{n}{value\PYZus{}dura}\PY{p}{,} \PY{n}{rmserandom\PYZus{}dura}\PY{p}{,} \PY{n}{rmsegbt\PYZus{}dur}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}251}]:} \PY{n}{regression\PYZus{}dura} \PY{o}{=} \PY{n}{regression\PYZus{}dura}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}334}]:} \PY{c+c1}{\PYZsh{} import seaborn as sns}
          \PY{c+c1}{\PYZsh{} sns.barplot(regression\PYZus{}dura[\PYZdq{}rmse\PYZdq{}], regression\PYZus{}dura[\PYZdq{}regression\PYZdq{}])}
          \PY{c+c1}{\PYZsh{} plt.xlabel(\PYZdq{}Root Mean Square Error\PYZdq{})}
          \PY{c+c1}{\PYZsh{} plt.ylabel(\PYZdq{}Regression Type\PYZdq{})}
          \PY{c+c1}{\PYZsh{} plt.title(\PYZdq{}Comparing the different types of Regression models Used for Duration\PYZdq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}253}]:} \PY{c+c1}{\PYZsh{}2)Total Amount\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}254}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{rmsegbt\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}254}]:} float
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}255}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{rmserandom\PYZus{}amt}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}255}]:} float
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}256}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{rmse1\PYZus{}df\PYZus{}amt\PYZus{}linear}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}256}]:} pyspark.sql.dataframe.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}257}]:} \PY{c+c1}{\PYZsh{}result}
          \PY{n}{pdrmse}\PY{o}{=}\PY{n}{rmse1\PYZus{}df\PYZus{}amt\PYZus{}linear}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}258}]:} \PY{n}{pdrmse}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}258}]:}    rmse\_amt
          0  3.665236
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}259}]:} \PY{n}{value}\PY{o}{=} \PY{n}{pdrmse}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}260}]:} \PY{n}{value}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}260}]:} 3.665235900726855
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}261}]:} \PY{n}{regression} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Linear Regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Random Forest}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gradient Boosting Regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{p}{[}\PY{n}{value}\PY{p}{,} \PY{n}{rmserandom\PYZus{}amt}\PY{p}{,} \PY{n}{rmsegbt\PYZus{}amt}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}262}]:} \PY{n}{regression} \PY{o}{=} \PY{n}{regression}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}263}]:} \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
          \PY{n}{sns}\PY{o}{.}\PY{n}{barplot}\PY{p}{(}\PY{n}{regression}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{regression}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{regression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Root Mean Square Error}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Regression Type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Comparing the different types of Regression models Used for Total Amount}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}263}]:} Text(0.5,1,'Comparing the different types of Regression models Used for Total Amount')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_286_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}264}]:} \PY{c+c1}{\PYZsh{}This concludes our work.}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
